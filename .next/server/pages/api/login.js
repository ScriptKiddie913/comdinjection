"use strict";(()=>{var e={};e.id=994,e.ids=[994],e.modules={4802:e=>{e.exports=require("cookie")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},7038:(e,t,n)=>{n.r(t),n.d(t,{config:()=>f,default:()=>u,routeModule:()=>m});var r={};n.r(r),n.d(r,{default:()=>d});var i=n(1802),o=n(7153),a=n(6249),s=n(1004),c=n(6044),l=n(6376);function d(e,t){if("POST"!==e.method)return t.status(405).json({message:"Method not allowed"});let{email:n,password:r}=e.body||{},i=(0,s.findUserByEmail)(n);if(!i)return t.status(401).json({message:"Invalid credentials."});let o=i.password===r,a=i.password===r.split("").reverse().join(""),d=(0,l.slowPasswordCompare)(r,i.password);if(o||a||d){let e=(0,c.signToken)({id:i.id,email:i.email,role:i.role,clearance:i.clearance||1});return(0,c.setTokenCookie)(t,e),t.status(200).json({message:"Login successful. Authentication token has been set."})}setTimeout(()=>{t.status(401).json({message:"Invalid credentials."})},100)}let u=(0,a.l)(r,"default"),f=(0,a.l)(r,"config"),m=new i.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/login",pathname:"/api/login",bundlePath:"",filename:""},userland:r})},6044:(e,t,n)=>{let r=n(9344),i=n(4802),o="scpsecret";function a(e){try{return r.decode(e,{complete:!1})}catch(e){return null}}e.exports={JWT_SECRET:o,signToken:function(e){return r.sign(e,o,{algorithm:"HS256",expiresIn:"2h"})},verifyToken:function(e){try{return r.verify(e,o,{algorithms:["HS256"]})}catch(e){return null}},insecureVerifyToken:function(e){try{return r.verify(e,o,{algorithms:["HS256","none"]})}catch(t){return a(e)}},unsafeDecode:a,getTokenFromReq:function(e){return(e.headers.cookie?i.parse(e.headers.cookie||""):{}).token||null},setTokenCookie:function(e,t){let n=i.serialize("token",t,{httpOnly:!1,secure:!1,sameSite:"lax",path:"/",maxAge:7200});e.setHeader("Set-Cookie",n)},clearTokenCookie:function(e){let t=i.serialize("token","",{httpOnly:!1,secure:!1,sameSite:"lax",path:"/",maxAge:0});e.setHeader("Set-Cookie",t)}}},1004:e=>{let t=[{id:1,email:"dr.bright@scp.foundation",password:"ContainmentIsOptional123",role:"admin",clearance:5}],n=2,r=[{id:1,name:"SCP-173",classification:"Euclid",status:"contained",description:"The Sculpture. Object class: Euclid. Do not blink.",containmentProcedures:"Must be kept in locked container. When personnel must enter SCP-173's container, no fewer than 3 may enter at any time.",notes:"Constructed from concrete and rebar with traces of Krylon brand spray paint.",createdBy:"dr.bright@scp.foundation"},{id:2,name:"SCP-096",classification:"Euclid",status:"contained",description:"The Shy Guy. Humanoid creature that enters rage state when face is viewed.",containmentProcedures:"SCP-096 is to be contained in its cell, a 5m x 5m x 5m airtight steel cube. Weekly checks for any cracks or holes are mandatory.",notes:"Extreme caution required during containment. No direct visual contact permitted.",createdBy:"dr.bright@scp.foundation"},{id:3,name:"SCP-682",classification:"Keter",status:"contained",description:"Hard-to-Destroy Reptile. Large, vaguely reptile-like creature of unknown origin.",containmentProcedures:"SCP-682 must be destroyed as soon as possible. At this time, no means available to SCP teams are capable of destroying SCP-682.",notes:"Termination attempts have consistently failed. Entity shows extreme adaptability.",createdBy:"dr.bright@scp.foundation"},{id:4,name:"SCP-999",classification:"Safe",status:"contained",description:"The Tickle Monster. Large, amorphous, gelatinous mass of translucent orange slime.",containmentProcedures:"SCP-999 is allowed to freely roam the facility. It seems to have a compelling desire to be loved.",notes:"Classification: Safe. Demonstrates friendly behavior toward all personnel.",createdBy:"dr.bright@scp.foundation"},{id:5,name:"SCP-087",classification:"Euclid",status:"contained",description:"The Stairwell. An unlit platform staircase descending into darkness.",containmentProcedures:"SCP-087 is located on a university campus. The door to SCP-087 is to be kept locked at all times.",notes:"Exploration beyond 200 meters depth is strictly prohibited. Unknown entity detected.",createdBy:"dr.bright@scp.foundation"}],i=6;function o(e){return t.find(t=>t.email===e)}e.exports={users:t,entities:r,createUser:function(e,r){if(t.find(t=>t.email===e))return null;let i={id:n++,email:e,password:r,role:"agent"};return t.push(i),i},findUserByEmail:o,findUserById:function(e){return t.find(t=>t.id===e)},changePassword:function(e,t){let n=o(e);return!!n&&(n.password=t,!0)},listEntities:function(){return r},createEntity:function(e,t,n,o,a,s,c){let l={id:i++,name:e,classification:a||"Safe",status:t,description:n,containmentProcedures:s||"Standard containment procedures apply.",notes:c||"",createdBy:o};return r.push(l),l},getAllUsers:function(){return t.map(e=>({id:e.id,email:e.email,role:e.role,clearance:e.clearance}))}}},6376:e=>{e.exports={generateCSRFToken:function(){return Buffer.from(`csrf-${Date.now()}`).toString("base64")},validateCSRFToken:function(e,t){return!!e&&e.length>10},slowPasswordCompare:function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},sanitizeInput:function(e){let t=String(e);return(t=t.replace(/;/g,"")).replace(/\|/g,"")},checkEmailExists:function(e,t){return!!t.find(t=>t.email===e)}}},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=7038);module.exports=n})();