"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/login";
exports.ids = ["pages/api/login"];
exports.modules = {

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Flogin.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Flogin.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_login_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/login.js */ \"(api)/./pages/api/login.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_login_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_login_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/login\",\n        pathname: \"/api/login\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_login_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmxvZ2luJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZsb2dpbi5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNpRDtBQUNqRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsZ0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGdEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL3NjcC1lbnRpdHktdHJhY2tpbmctY3RmLz9jZWM4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvbG9naW4uanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9sb2dpblwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2xvZ2luXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Flogin.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/auth.js":
/*!*********************!*\
  !*** ./lib/auth.js ***!
  \*********************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nconst cookie = __webpack_require__(/*! cookie */ \"cookie\");\n// Weak secret – leaked in source (vuln).\nconst JWT_SECRET = \"scpsecret\";\n// Vulnerable: We also accept 'none' algorithm and don't verify properly in some places.\nfunction signToken(payload) {\n    return jwt.sign(payload, JWT_SECRET, {\n        algorithm: \"HS256\",\n        expiresIn: \"2h\"\n    });\n}\n// Proper verification (but some endpoints will skip it intentionally).\nfunction verifyToken(token) {\n    try {\n        return jwt.verify(token, JWT_SECRET, {\n            algorithms: [\n                \"HS256\"\n            ]\n        });\n    } catch (e) {\n        return null;\n    }\n}\n// VULN: Insecure verification that accepts 'none' algorithm\nfunction insecureVerifyToken(token) {\n    try {\n        // This accepts tokens with no signature (algorithm: 'none')\n        return jwt.verify(token, JWT_SECRET, {\n            algorithms: [\n                \"HS256\",\n                \"none\"\n            ]\n        });\n    } catch (e) {\n        // If standard verification fails, try decoding anyway\n        return unsafeDecode(token);\n    }\n}\n// Insecure: decode without verification (for role checks in some places).\nfunction unsafeDecode(token) {\n    try {\n        return jwt.decode(token, {\n            complete: false\n        });\n    } catch (e) {\n        return null;\n    }\n}\n// VULN: Weak secret allows easy brute-forcing\nfunction canBruteForce() {\n    // The secret \"scpsecret\" is weak and visible in source\n    // It can be cracked with tools like john or hashcat\n    return true;\n}\nfunction getTokenFromReq(req) {\n    const cookies = req.headers.cookie ? cookie.parse(req.headers.cookie || \"\") : {};\n    return cookies[\"token\"] || null;\n}\nfunction setTokenCookie(res, token) {\n    const header = cookie.serialize(\"token\", token, {\n        httpOnly: false,\n        secure: false,\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 7200 // 2 hours\n    });\n    res.setHeader(\"Set-Cookie\", header);\n}\nfunction clearTokenCookie(res) {\n    const header = cookie.serialize(\"token\", \"\", {\n        httpOnly: false,\n        secure: false,\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 0\n    });\n    res.setHeader(\"Set-Cookie\", header);\n}\nmodule.exports = {\n    JWT_SECRET,\n    signToken,\n    verifyToken,\n    insecureVerifyToken,\n    unsafeDecode,\n    getTokenFromReq,\n    setTokenCookie,\n    clearTokenCookie\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC5qcyIsIm1hcHBpbmdzIjoiO0FBQUEsTUFBTUEsTUFBTUMsbUJBQU9BLENBQUMsa0NBQWM7QUFDbEMsTUFBTUMsU0FBU0QsbUJBQU9BLENBQUMsc0JBQVE7QUFFL0IseUNBQXlDO0FBQ3pDLE1BQU1FLGFBQWE7QUFFbkIsd0ZBQXdGO0FBQ3hGLFNBQVNDLFVBQVVDLE9BQU87SUFDeEIsT0FBT0wsSUFBSU0sSUFBSSxDQUFDRCxTQUFTRixZQUFZO1FBQUVJLFdBQVc7UUFBU0MsV0FBVztJQUFLO0FBQzdFO0FBRUEsdUVBQXVFO0FBQ3ZFLFNBQVNDLFlBQVlDLEtBQUs7SUFDeEIsSUFBSTtRQUNGLE9BQU9WLElBQUlXLE1BQU0sQ0FBQ0QsT0FBT1AsWUFBWTtZQUFFUyxZQUFZO2dCQUFDO2FBQVE7UUFBQztJQUMvRCxFQUFFLE9BQU9DLEdBQUc7UUFDVixPQUFPO0lBQ1Q7QUFDRjtBQUVBLDREQUE0RDtBQUM1RCxTQUFTQyxvQkFBb0JKLEtBQUs7SUFDaEMsSUFBSTtRQUNGLDREQUE0RDtRQUM1RCxPQUFPVixJQUFJVyxNQUFNLENBQUNELE9BQU9QLFlBQVk7WUFBRVMsWUFBWTtnQkFBQztnQkFBUzthQUFPO1FBQUM7SUFDdkUsRUFBRSxPQUFPQyxHQUFHO1FBQ1Ysc0RBQXNEO1FBQ3RELE9BQU9FLGFBQWFMO0lBQ3RCO0FBQ0Y7QUFFQSwwRUFBMEU7QUFDMUUsU0FBU0ssYUFBYUwsS0FBSztJQUN6QixJQUFJO1FBQ0YsT0FBT1YsSUFBSWdCLE1BQU0sQ0FBQ04sT0FBTztZQUFFTyxVQUFVO1FBQU07SUFDN0MsRUFBRSxPQUFPSixHQUFHO1FBQ1YsT0FBTztJQUNUO0FBQ0Y7QUFFQSw4Q0FBOEM7QUFDOUMsU0FBU0s7SUFDUCx1REFBdUQ7SUFDdkQsb0RBQW9EO0lBQ3BELE9BQU87QUFDVDtBQUVBLFNBQVNDLGdCQUFnQkMsR0FBRztJQUMxQixNQUFNQyxVQUFVRCxJQUFJRSxPQUFPLENBQUNwQixNQUFNLEdBQzlCQSxPQUFPcUIsS0FBSyxDQUFDSCxJQUFJRSxPQUFPLENBQUNwQixNQUFNLElBQUksTUFDbkMsQ0FBQztJQUNMLE9BQU9tQixPQUFPLENBQUMsUUFBUSxJQUFJO0FBQzdCO0FBRUEsU0FBU0csZUFBZUMsR0FBRyxFQUFFZixLQUFLO0lBQ2hDLE1BQU1nQixTQUFTeEIsT0FBT3lCLFNBQVMsQ0FBQyxTQUFTakIsT0FBTztRQUM5Q2tCLFVBQVU7UUFDVkMsUUFBUTtRQUNSQyxVQUFVO1FBQ1ZDLE1BQU07UUFDTkMsUUFBUSxLQUFLLFVBQVU7SUFDekI7SUFDQVAsSUFBSVEsU0FBUyxDQUFDLGNBQWNQO0FBQzlCO0FBRUEsU0FBU1EsaUJBQWlCVCxHQUFHO0lBQzNCLE1BQU1DLFNBQVN4QixPQUFPeUIsU0FBUyxDQUFDLFNBQVMsSUFBSTtRQUMzQ0MsVUFBVTtRQUNWQyxRQUFRO1FBQ1JDLFVBQVU7UUFDVkMsTUFBTTtRQUNOQyxRQUFRO0lBQ1Y7SUFDQVAsSUFBSVEsU0FBUyxDQUFDLGNBQWNQO0FBQzlCO0FBRUFTLE9BQU9DLE9BQU8sR0FBRztJQUNmakM7SUFDQUM7SUFDQUs7SUFDQUs7SUFDQUM7SUFDQUk7SUFDQUs7SUFDQVU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NjcC1lbnRpdHktdHJhY2tpbmctY3RmLy4vbGliL2F1dGguanM/Mjg3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xuY29uc3QgY29va2llID0gcmVxdWlyZShcImNvb2tpZVwiKTtcblxuLy8gV2VhayBzZWNyZXQg4oCTIGxlYWtlZCBpbiBzb3VyY2UgKHZ1bG4pLlxuY29uc3QgSldUX1NFQ1JFVCA9IFwic2Nwc2VjcmV0XCI7XG5cbi8vIFZ1bG5lcmFibGU6IFdlIGFsc28gYWNjZXB0ICdub25lJyBhbGdvcml0aG0gYW5kIGRvbid0IHZlcmlmeSBwcm9wZXJseSBpbiBzb21lIHBsYWNlcy5cbmZ1bmN0aW9uIHNpZ25Ub2tlbihwYXlsb2FkKSB7XG4gIHJldHVybiBqd3Quc2lnbihwYXlsb2FkLCBKV1RfU0VDUkVULCB7IGFsZ29yaXRobTogXCJIUzI1NlwiLCBleHBpcmVzSW46IFwiMmhcIiB9KTtcbn1cblxuLy8gUHJvcGVyIHZlcmlmaWNhdGlvbiAoYnV0IHNvbWUgZW5kcG9pbnRzIHdpbGwgc2tpcCBpdCBpbnRlbnRpb25hbGx5KS5cbmZ1bmN0aW9uIHZlcmlmeVRva2VuKHRva2VuKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4sIEpXVF9TRUNSRVQsIHsgYWxnb3JpdGhtczogW1wiSFMyNTZcIl0gfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyBWVUxOOiBJbnNlY3VyZSB2ZXJpZmljYXRpb24gdGhhdCBhY2NlcHRzICdub25lJyBhbGdvcml0aG1cbmZ1bmN0aW9uIGluc2VjdXJlVmVyaWZ5VG9rZW4odG9rZW4pIHtcbiAgdHJ5IHtcbiAgICAvLyBUaGlzIGFjY2VwdHMgdG9rZW5zIHdpdGggbm8gc2lnbmF0dXJlIChhbGdvcml0aG06ICdub25lJylcbiAgICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCwgeyBhbGdvcml0aG1zOiBbXCJIUzI1NlwiLCBcIm5vbmVcIl0gfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBJZiBzdGFuZGFyZCB2ZXJpZmljYXRpb24gZmFpbHMsIHRyeSBkZWNvZGluZyBhbnl3YXlcbiAgICByZXR1cm4gdW5zYWZlRGVjb2RlKHRva2VuKTtcbiAgfVxufVxuXG4vLyBJbnNlY3VyZTogZGVjb2RlIHdpdGhvdXQgdmVyaWZpY2F0aW9uIChmb3Igcm9sZSBjaGVja3MgaW4gc29tZSBwbGFjZXMpLlxuZnVuY3Rpb24gdW5zYWZlRGVjb2RlKHRva2VuKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGp3dC5kZWNvZGUodG9rZW4sIHsgY29tcGxldGU6IGZhbHNlIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gVlVMTjogV2VhayBzZWNyZXQgYWxsb3dzIGVhc3kgYnJ1dGUtZm9yY2luZ1xuZnVuY3Rpb24gY2FuQnJ1dGVGb3JjZSgpIHtcbiAgLy8gVGhlIHNlY3JldCBcInNjcHNlY3JldFwiIGlzIHdlYWsgYW5kIHZpc2libGUgaW4gc291cmNlXG4gIC8vIEl0IGNhbiBiZSBjcmFja2VkIHdpdGggdG9vbHMgbGlrZSBqb2huIG9yIGhhc2hjYXRcbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGdldFRva2VuRnJvbVJlcShyZXEpIHtcbiAgY29uc3QgY29va2llcyA9IHJlcS5oZWFkZXJzLmNvb2tpZVxuICAgID8gY29va2llLnBhcnNlKHJlcS5oZWFkZXJzLmNvb2tpZSB8fCBcIlwiKVxuICAgIDoge307XG4gIHJldHVybiBjb29raWVzW1widG9rZW5cIl0gfHwgbnVsbDtcbn1cblxuZnVuY3Rpb24gc2V0VG9rZW5Db29raWUocmVzLCB0b2tlbikge1xuICBjb25zdCBoZWFkZXIgPSBjb29raWUuc2VyaWFsaXplKFwidG9rZW5cIiwgdG9rZW4sIHtcbiAgICBodHRwT25seTogZmFsc2UsIC8vIHZ1bG46IEpTIGFjY2Vzc2libGVcbiAgICBzZWN1cmU6IGZhbHNlLCAgIC8vIHZ1bG46IHdvcmtzIG92ZXIgSFRUUFxuICAgIHNhbWVTaXRlOiBcImxheFwiLCAvLyB2dWxuOiBDU1JGLXByb25lIChub3QgJ3N0cmljdCcpXG4gICAgcGF0aDogXCIvXCIsXG4gICAgbWF4QWdlOiA3MjAwIC8vIDIgaG91cnNcbiAgfSk7XG4gIHJlcy5zZXRIZWFkZXIoXCJTZXQtQ29va2llXCIsIGhlYWRlcik7XG59XG5cbmZ1bmN0aW9uIGNsZWFyVG9rZW5Db29raWUocmVzKSB7XG4gIGNvbnN0IGhlYWRlciA9IGNvb2tpZS5zZXJpYWxpemUoXCJ0b2tlblwiLCBcIlwiLCB7XG4gICAgaHR0cE9ubHk6IGZhbHNlLFxuICAgIHNlY3VyZTogZmFsc2UsXG4gICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gICAgcGF0aDogXCIvXCIsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xuICByZXMuc2V0SGVhZGVyKFwiU2V0LUNvb2tpZVwiLCBoZWFkZXIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgSldUX1NFQ1JFVCxcbiAgc2lnblRva2VuLFxuICB2ZXJpZnlUb2tlbixcbiAgaW5zZWN1cmVWZXJpZnlUb2tlbixcbiAgdW5zYWZlRGVjb2RlLFxuICBnZXRUb2tlbkZyb21SZXEsXG4gIHNldFRva2VuQ29va2llLFxuICBjbGVhclRva2VuQ29va2llXG59O1xuIl0sIm5hbWVzIjpbImp3dCIsInJlcXVpcmUiLCJjb29raWUiLCJKV1RfU0VDUkVUIiwic2lnblRva2VuIiwicGF5bG9hZCIsInNpZ24iLCJhbGdvcml0aG0iLCJleHBpcmVzSW4iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwidmVyaWZ5IiwiYWxnb3JpdGhtcyIsImUiLCJpbnNlY3VyZVZlcmlmeVRva2VuIiwidW5zYWZlRGVjb2RlIiwiZGVjb2RlIiwiY29tcGxldGUiLCJjYW5CcnV0ZUZvcmNlIiwiZ2V0VG9rZW5Gcm9tUmVxIiwicmVxIiwiY29va2llcyIsImhlYWRlcnMiLCJwYXJzZSIsInNldFRva2VuQ29va2llIiwicmVzIiwiaGVhZGVyIiwic2VyaWFsaXplIiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsInBhdGgiLCJtYXhBZ2UiLCJzZXRIZWFkZXIiLCJjbGVhclRva2VuQ29va2llIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/auth.js\n");

/***/ }),

/***/ "(api)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((module) => {

eval("// Extremely insecure in-memory \"database\" for the CTF.\n// Data resets on each deployment / restart – fine for CTF.\n\nconst users = [\n    // pre-created admin with weak credentials\n    {\n        id: 1,\n        email: \"dr.bright@scp.foundation\",\n        password: \"ContainmentIsOptional123\",\n        role: \"admin\",\n        clearance: 5\n    }\n];\nlet nextUserId = 2;\nconst entities = [\n    {\n        id: 1,\n        name: \"SCP-173\",\n        classification: \"Euclid\",\n        status: \"contained\",\n        description: \"The Sculpture. Object class: Euclid. Do not blink.\",\n        containmentProcedures: \"Must be kept in locked container. When personnel must enter SCP-173's container, no fewer than 3 may enter at any time.\",\n        notes: \"Constructed from concrete and rebar with traces of Krylon brand spray paint.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 2,\n        name: \"SCP-096\",\n        classification: \"Euclid\",\n        status: \"contained\",\n        description: \"The Shy Guy. Humanoid creature that enters rage state when face is viewed.\",\n        containmentProcedures: \"SCP-096 is to be contained in its cell, a 5m x 5m x 5m airtight steel cube. Weekly checks for any cracks or holes are mandatory.\",\n        notes: \"Hint: JWT secrets might be as fragile as 096's containment. Check the source code carefully.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 3,\n        name: \"SCP-682\",\n        classification: \"Keter\",\n        status: \"contained\",\n        description: \"Hard-to-Destroy Reptile. Large, vaguely reptile-like creature of unknown origin.\",\n        containmentProcedures: \"SCP-682 must be destroyed as soon as possible. At this time, no means available to SCP teams are capable of destroying SCP-682.\",\n        notes: \"Like 682, some security measures are nearly impossible to destroy. But tokens? Those can be tampered with...\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 4,\n        name: \"SCP-999\",\n        classification: \"Safe\",\n        status: \"contained\",\n        description: \"The Tickle Monster. Large, amorphous, gelatinous mass of translucent orange slime.\",\n        containmentProcedures: \"SCP-999 is allowed to freely roam the facility. It seems to have a compelling desire to be loved.\",\n        notes: \"Classification: Safe. Unlike our admin endpoints - those lack CSRF protection entirely.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 5,\n        name: \"SCP-087\",\n        classification: \"Euclid\",\n        status: \"contained\",\n        description: \"The Stairwell. An unlit platform staircase descending into darkness.\",\n        containmentProcedures: \"SCP-087 is located on a university campus. The door to SCP-087 is to be kept locked at all times.\",\n        notes: \"Going down the rabbit hole? Remember: command filters can be bypassed with creative syntax. Try $IFS or &&.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    }\n];\nlet nextEntityId = 6;\nfunction createUser(email, password) {\n    const existing = users.find((u)=>u.email === email);\n    if (existing) return null;\n    const user = {\n        id: nextUserId++,\n        email,\n        password,\n        role: \"agent\"\n    };\n    users.push(user);\n    return user;\n}\nfunction findUserByEmail(email) {\n    return users.find((u)=>u.email === email);\n}\nfunction findUserById(id) {\n    return users.find((u)=>u.id === id);\n}\nfunction changePassword(email, newPassword) {\n    const user = findUserByEmail(email);\n    if (!user) return false;\n    user.password = newPassword;\n    return true;\n}\nfunction listEntities() {\n    return entities;\n}\nfunction createEntity(name, status, description, createdByEmail, classification, containmentProcedures, notes) {\n    const ent = {\n        id: nextEntityId++,\n        name,\n        classification: classification || \"Safe\",\n        status,\n        description,\n        containmentProcedures: containmentProcedures || \"Standard containment procedures apply.\",\n        notes: notes || \"\",\n        createdBy: createdByEmail\n    };\n    entities.push(ent);\n    return ent;\n}\nfunction getAllUsers() {\n    return users.map((u)=>({\n            id: u.id,\n            email: u.email,\n            role: u.role,\n            clearance: u.clearance\n        }));\n}\nmodule.exports = {\n    users,\n    entities,\n    createUser,\n    findUserByEmail,\n    findUserById,\n    changePassword,\n    listEntities,\n    createEntity,\n    getAllUsers\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ0FDO0lBQ0FHO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY3AtZW50aXR5LXRyYWNraW5nLWN0Zi8uL2xpYi9kYi5qcz8zZGM5Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIEV4dHJlbWVseSBpbnNlY3VyZSBpbi1tZW1vcnkgXCJkYXRhYmFzZVwiIGZvciB0aGUgQ1RGLlxuLy8gRGF0YSByZXNldHMgb24gZWFjaCBkZXBsb3ltZW50IC8gcmVzdGFydCDigJMgZmluZSBmb3IgQ1RGLlxuXG5jb25zdCB1c2VycyA9IFtcbiAgLy8gcHJlLWNyZWF0ZWQgYWRtaW4gd2l0aCB3ZWFrIGNyZWRlbnRpYWxzXG4gIHtcbiAgICBpZDogMSxcbiAgICBlbWFpbDogXCJkci5icmlnaHRAc2NwLmZvdW5kYXRpb25cIixcbiAgICBwYXNzd29yZDogXCJDb250YWlubWVudElzT3B0aW9uYWwxMjNcIiwgLy8gc3RvcmVkIGluIGNsZWFydGV4dCAodnVsbilcbiAgICByb2xlOiBcImFkbWluXCIsXG4gICAgY2xlYXJhbmNlOiA1XG4gIH1cbl07XG5cbmxldCBuZXh0VXNlcklkID0gMjtcblxuY29uc3QgZW50aXRpZXMgPSBbXG4gIHtcbiAgICBpZDogMSxcbiAgICBuYW1lOiBcIlNDUC0xNzNcIixcbiAgICBjbGFzc2lmaWNhdGlvbjogXCJFdWNsaWRcIixcbiAgICBzdGF0dXM6IFwiY29udGFpbmVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiVGhlIFNjdWxwdHVyZS4gT2JqZWN0IGNsYXNzOiBFdWNsaWQuIERvIG5vdCBibGluay5cIixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IFwiTXVzdCBiZSBrZXB0IGluIGxvY2tlZCBjb250YWluZXIuIFdoZW4gcGVyc29ubmVsIG11c3QgZW50ZXIgU0NQLTE3MydzIGNvbnRhaW5lciwgbm8gZmV3ZXIgdGhhbiAzIG1heSBlbnRlciBhdCBhbnkgdGltZS5cIixcbiAgICBub3RlczogXCJDb25zdHJ1Y3RlZCBmcm9tIGNvbmNyZXRlIGFuZCByZWJhciB3aXRoIHRyYWNlcyBvZiBLcnlsb24gYnJhbmQgc3ByYXkgcGFpbnQuXCIsXG4gICAgY3JlYXRlZEJ5OiBcImRyLmJyaWdodEBzY3AuZm91bmRhdGlvblwiXG4gIH0sXG4gIHtcbiAgICBpZDogMixcbiAgICBuYW1lOiBcIlNDUC0wOTZcIixcbiAgICBjbGFzc2lmaWNhdGlvbjogXCJFdWNsaWRcIixcbiAgICBzdGF0dXM6IFwiY29udGFpbmVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiVGhlIFNoeSBHdXkuIEh1bWFub2lkIGNyZWF0dXJlIHRoYXQgZW50ZXJzIHJhZ2Ugc3RhdGUgd2hlbiBmYWNlIGlzIHZpZXdlZC5cIixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IFwiU0NQLTA5NiBpcyB0byBiZSBjb250YWluZWQgaW4gaXRzIGNlbGwsIGEgNW0geCA1bSB4IDVtIGFpcnRpZ2h0IHN0ZWVsIGN1YmUuIFdlZWtseSBjaGVja3MgZm9yIGFueSBjcmFja3Mgb3IgaG9sZXMgYXJlIG1hbmRhdG9yeS5cIixcbiAgICBub3RlczogXCJIaW50OiBKV1Qgc2VjcmV0cyBtaWdodCBiZSBhcyBmcmFnaWxlIGFzIDA5NidzIGNvbnRhaW5tZW50LiBDaGVjayB0aGUgc291cmNlIGNvZGUgY2FyZWZ1bGx5LlwiLFxuICAgIGNyZWF0ZWRCeTogXCJkci5icmlnaHRAc2NwLmZvdW5kYXRpb25cIlxuICB9LFxuICB7XG4gICAgaWQ6IDMsXG4gICAgbmFtZTogXCJTQ1AtNjgyXCIsXG4gICAgY2xhc3NpZmljYXRpb246IFwiS2V0ZXJcIixcbiAgICBzdGF0dXM6IFwiY29udGFpbmVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiSGFyZC10by1EZXN0cm95IFJlcHRpbGUuIExhcmdlLCB2YWd1ZWx5IHJlcHRpbGUtbGlrZSBjcmVhdHVyZSBvZiB1bmtub3duIG9yaWdpbi5cIixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IFwiU0NQLTY4MiBtdXN0IGJlIGRlc3Ryb3llZCBhcyBzb29uIGFzIHBvc3NpYmxlLiBBdCB0aGlzIHRpbWUsIG5vIG1lYW5zIGF2YWlsYWJsZSB0byBTQ1AgdGVhbXMgYXJlIGNhcGFibGUgb2YgZGVzdHJveWluZyBTQ1AtNjgyLlwiLFxuICAgIG5vdGVzOiBcIkxpa2UgNjgyLCBzb21lIHNlY3VyaXR5IG1lYXN1cmVzIGFyZSBuZWFybHkgaW1wb3NzaWJsZSB0byBkZXN0cm95LiBCdXQgdG9rZW5zPyBUaG9zZSBjYW4gYmUgdGFtcGVyZWQgd2l0aC4uLlwiLFxuICAgIGNyZWF0ZWRCeTogXCJkci5icmlnaHRAc2NwLmZvdW5kYXRpb25cIlxuICB9LFxuICB7XG4gICAgaWQ6IDQsXG4gICAgbmFtZTogXCJTQ1AtOTk5XCIsXG4gICAgY2xhc3NpZmljYXRpb246IFwiU2FmZVwiLFxuICAgIHN0YXR1czogXCJjb250YWluZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJUaGUgVGlja2xlIE1vbnN0ZXIuIExhcmdlLCBhbW9ycGhvdXMsIGdlbGF0aW5vdXMgbWFzcyBvZiB0cmFuc2x1Y2VudCBvcmFuZ2Ugc2xpbWUuXCIsXG4gICAgY29udGFpbm1lbnRQcm9jZWR1cmVzOiBcIlNDUC05OTkgaXMgYWxsb3dlZCB0byBmcmVlbHkgcm9hbSB0aGUgZmFjaWxpdHkuIEl0IHNlZW1zIHRvIGhhdmUgYSBjb21wZWxsaW5nIGRlc2lyZSB0byBiZSBsb3ZlZC5cIixcbiAgICBub3RlczogXCJDbGFzc2lmaWNhdGlvbjogU2FmZS4gVW5saWtlIG91ciBhZG1pbiBlbmRwb2ludHMgLSB0aG9zZSBsYWNrIENTUkYgcHJvdGVjdGlvbiBlbnRpcmVseS5cIixcbiAgICBjcmVhdGVkQnk6IFwiZHIuYnJpZ2h0QHNjcC5mb3VuZGF0aW9uXCJcbiAgfSxcbiAge1xuICAgIGlkOiA1LFxuICAgIG5hbWU6IFwiU0NQLTA4N1wiLFxuICAgIGNsYXNzaWZpY2F0aW9uOiBcIkV1Y2xpZFwiLFxuICAgIHN0YXR1czogXCJjb250YWluZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJUaGUgU3RhaXJ3ZWxsLiBBbiB1bmxpdCBwbGF0Zm9ybSBzdGFpcmNhc2UgZGVzY2VuZGluZyBpbnRvIGRhcmtuZXNzLlwiLFxuICAgIGNvbnRhaW5tZW50UHJvY2VkdXJlczogXCJTQ1AtMDg3IGlzIGxvY2F0ZWQgb24gYSB1bml2ZXJzaXR5IGNhbXB1cy4gVGhlIGRvb3IgdG8gU0NQLTA4NyBpcyB0byBiZSBrZXB0IGxvY2tlZCBhdCBhbGwgdGltZXMuXCIsXG4gICAgbm90ZXM6IFwiR29pbmcgZG93biB0aGUgcmFiYml0IGhvbGU/IFJlbWVtYmVyOiBjb21tYW5kIGZpbHRlcnMgY2FuIGJlIGJ5cGFzc2VkIHdpdGggY3JlYXRpdmUgc3ludGF4LiBUcnkgJElGUyBvciAmJi5cIixcbiAgICBjcmVhdGVkQnk6IFwiZHIuYnJpZ2h0QHNjcC5mb3VuZGF0aW9uXCJcbiAgfVxuXTtcblxubGV0IG5leHRFbnRpdHlJZCA9IDY7XG5cbmZ1bmN0aW9uIGNyZWF0ZVVzZXIoZW1haWwsIHBhc3N3b3JkKSB7XG4gIGNvbnN0IGV4aXN0aW5nID0gdXNlcnMuZmluZCgodSkgPT4gdS5lbWFpbCA9PT0gZW1haWwpO1xuICBpZiAoZXhpc3RpbmcpIHJldHVybiBudWxsO1xuICBjb25zdCB1c2VyID0geyBpZDogbmV4dFVzZXJJZCsrLCBlbWFpbCwgcGFzc3dvcmQsIHJvbGU6IFwiYWdlbnRcIiB9O1xuICB1c2Vycy5wdXNoKHVzZXIpO1xuICByZXR1cm4gdXNlcjtcbn1cblxuZnVuY3Rpb24gZmluZFVzZXJCeUVtYWlsKGVtYWlsKSB7XG4gIHJldHVybiB1c2Vycy5maW5kKCh1KSA9PiB1LmVtYWlsID09PSBlbWFpbCk7XG59XG5cbmZ1bmN0aW9uIGZpbmRVc2VyQnlJZChpZCkge1xuICByZXR1cm4gdXNlcnMuZmluZCgodSkgPT4gdS5pZCA9PT0gaWQpO1xufVxuXG5mdW5jdGlvbiBjaGFuZ2VQYXNzd29yZChlbWFpbCwgbmV3UGFzc3dvcmQpIHtcbiAgY29uc3QgdXNlciA9IGZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gIGlmICghdXNlcikgcmV0dXJuIGZhbHNlO1xuICB1c2VyLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBsaXN0RW50aXRpZXMoKSB7XG4gIHJldHVybiBlbnRpdGllcztcbn1cblxuZnVuY3Rpb24gY3JlYXRlRW50aXR5KG5hbWUsIHN0YXR1cywgZGVzY3JpcHRpb24sIGNyZWF0ZWRCeUVtYWlsLCBjbGFzc2lmaWNhdGlvbiwgY29udGFpbm1lbnRQcm9jZWR1cmVzLCBub3Rlcykge1xuICBjb25zdCBlbnQgPSB7XG4gICAgaWQ6IG5leHRFbnRpdHlJZCsrLFxuICAgIG5hbWUsXG4gICAgY2xhc3NpZmljYXRpb246IGNsYXNzaWZpY2F0aW9uIHx8IFwiU2FmZVwiLFxuICAgIHN0YXR1cyxcbiAgICBkZXNjcmlwdGlvbixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IGNvbnRhaW5tZW50UHJvY2VkdXJlcyB8fCBcIlN0YW5kYXJkIGNvbnRhaW5tZW50IHByb2NlZHVyZXMgYXBwbHkuXCIsXG4gICAgbm90ZXM6IG5vdGVzIHx8IFwiXCIsXG4gICAgY3JlYXRlZEJ5OiBjcmVhdGVkQnlFbWFpbFxuICB9O1xuICBlbnRpdGllcy5wdXNoKGVudCk7XG4gIHJldHVybiBlbnQ7XG59XG5cbmZ1bmN0aW9uIGdldEFsbFVzZXJzKCkge1xuICByZXR1cm4gdXNlcnMubWFwKHUgPT4gKHsgaWQ6IHUuaWQsIGVtYWlsOiB1LmVtYWlsLCByb2xlOiB1LnJvbGUsIGNsZWFyYW5jZTogdS5jbGVhcmFuY2UgfSkpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdXNlcnMsXG4gIGVudGl0aWVzLFxuICBjcmVhdGVVc2VyLFxuICBmaW5kVXNlckJ5RW1haWwsXG4gIGZpbmRVc2VyQnlJZCxcbiAgY2hhbmdlUGFzc3dvcmQsXG4gIGxpc3RFbnRpdGllcyxcbiAgY3JlYXRlRW50aXR5LFxuICBnZXRBbGxVc2Vyc1xufTtcbiJdLCJuYW1lcyI6WyJ1c2VycyIsImlkIiwiZW1haWwiLCJwYXNzd29yZCIsInJvbGUiLCJjbGVhcmFuY2UiLCJuZXh0VXNlcklkIiwiZW50aXRpZXMiLCJuYW1lIiwiY2xhc3NpZmljYXRpb24iLCJzdGF0dXMiLCJkZXNjcmlwdGlvbiIsImNvbnRhaW5tZW50UHJvY2VkdXJlcyIsIm5vdGVzIiwiY3JlYXRlZEJ5IiwibmV4dEVudGl0eUlkIiwiY3JlYXRlVXNlciIsImV4aXN0aW5nIiwiZmluZCIsInUiLCJ1c2VyIiwicHVzaCIsImZpbmRVc2VyQnlFbWFpbCIsImZpbmRVc2VyQnlJZCIsImNoYW5nZVBhc3N3b3JkIiwibmV3UGFzc3dvcmQiLCJsaXN0RW50aXRpZXMiLCJjcmVhdGVFbnRpdHkiLCJjcmVhdGVkQnlFbWFpbCIsImVudCIsImdldEFsbFVzZXJzIiwibWFwIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/db.js\n");

/***/ }),

/***/ "(api)/./lib/security.js":
/*!*************************!*\
  !*** ./lib/security.js ***!
  \*************************/
/***/ ((module) => {

eval("// Security utilities (intentionally flawed for CTF)\n// Weak CSRF token generation (predictable)\n\nfunction generateCSRFToken() {\n    // VULN: Predictable token based on timestamp\n    return Buffer.from(`csrf-${Date.now()}`).toString(\"base64\");\n}\n// Broken CSRF validation (always returns true if token exists)\nfunction validateCSRFToken(token, expected) {\n    // VULN: Just checks if token exists, doesn't validate properly\n    if (!token) return false;\n    if (token.length > 10) return true; // weak check\n    return false;\n}\n// Timing attack vulnerable password comparison\nfunction slowPasswordCompare(input, actual) {\n    // VULN: Character-by-character comparison allows timing attacks\n    if (input.length !== actual.length) return false;\n    for(let i = 0; i < input.length; i++){\n        if (input[i] !== actual[i]) return false;\n    }\n    return true;\n}\n// Weak input sanitization\nfunction sanitizeInput(input) {\n    // VULN: Only removes obvious patterns, easy to bypass\n    let sanitized = String(input);\n    sanitized = sanitized.replace(/;/g, \"\");\n    sanitized = sanitized.replace(/\\|/g, \"\");\n    // Missing: &&, ||, $(), ``, $IFS, etc.\n    return sanitized;\n}\n// Email enumeration helper (intentionally leaky)\nfunction checkEmailExists(email, users) {\n    // VULN: Different response times/messages allow email enumeration\n    const found = users.find((u)=>u.email === email);\n    return !!found;\n}\nmodule.exports = {\n    generateCSRFToken,\n    validateCSRFToken,\n    slowPasswordCompare,\n    sanitizeInput,\n    checkEmailExists\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc2VjdXJpdHkuanMiLCJtYXBwaW5ncyI6IkFBQUEsb0RBQW9EO0FBRXBELDJDQUEyQzs7QUFDM0MsU0FBU0E7SUFDUCw2Q0FBNkM7SUFDN0MsT0FBT0MsT0FBT0MsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFQyxLQUFLQyxHQUFHLEdBQUcsQ0FBQyxFQUFFQyxRQUFRLENBQUM7QUFDcEQ7QUFFQSwrREFBK0Q7QUFDL0QsU0FBU0Msa0JBQWtCQyxLQUFLLEVBQUVDLFFBQVE7SUFDeEMsK0RBQStEO0lBQy9ELElBQUksQ0FBQ0QsT0FBTyxPQUFPO0lBQ25CLElBQUlBLE1BQU1FLE1BQU0sR0FBRyxJQUFJLE9BQU8sTUFBTSxhQUFhO0lBQ2pELE9BQU87QUFDVDtBQUVBLCtDQUErQztBQUMvQyxTQUFTQyxvQkFBb0JDLEtBQUssRUFBRUMsTUFBTTtJQUN4QyxnRUFBZ0U7SUFDaEUsSUFBSUQsTUFBTUYsTUFBTSxLQUFLRyxPQUFPSCxNQUFNLEVBQUUsT0FBTztJQUMzQyxJQUFLLElBQUlJLElBQUksR0FBR0EsSUFBSUYsTUFBTUYsTUFBTSxFQUFFSSxJQUFLO1FBQ3JDLElBQUlGLEtBQUssQ0FBQ0UsRUFBRSxLQUFLRCxNQUFNLENBQUNDLEVBQUUsRUFBRSxPQUFPO0lBQ3JDO0lBQ0EsT0FBTztBQUNUO0FBRUEsMEJBQTBCO0FBQzFCLFNBQVNDLGNBQWNILEtBQUs7SUFDMUIsc0RBQXNEO0lBQ3RELElBQUlJLFlBQVlDLE9BQU9MO0lBQ3ZCSSxZQUFZQSxVQUFVRSxPQUFPLENBQUMsTUFBTTtJQUNwQ0YsWUFBWUEsVUFBVUUsT0FBTyxDQUFDLE9BQU87SUFDckMsdUNBQXVDO0lBQ3ZDLE9BQU9GO0FBQ1Q7QUFFQSxpREFBaUQ7QUFDakQsU0FBU0csaUJBQWlCQyxLQUFLLEVBQUVDLEtBQUs7SUFDcEMsa0VBQWtFO0lBQ2xFLE1BQU1DLFFBQVFELE1BQU1FLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUosS0FBSyxLQUFLQTtJQUMxQyxPQUFPLENBQUMsQ0FBQ0U7QUFDWDtBQUVBRyxPQUFPQyxPQUFPLEdBQUc7SUFDZnpCO0lBQ0FNO0lBQ0FJO0lBQ0FJO0lBQ0FJO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY3AtZW50aXR5LXRyYWNraW5nLWN0Zi8uL2xpYi9zZWN1cml0eS5qcz8xYzM1Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNlY3VyaXR5IHV0aWxpdGllcyAoaW50ZW50aW9uYWxseSBmbGF3ZWQgZm9yIENURilcblxuLy8gV2VhayBDU1JGIHRva2VuIGdlbmVyYXRpb24gKHByZWRpY3RhYmxlKVxuZnVuY3Rpb24gZ2VuZXJhdGVDU1JGVG9rZW4oKSB7XG4gIC8vIFZVTE46IFByZWRpY3RhYmxlIHRva2VuIGJhc2VkIG9uIHRpbWVzdGFtcFxuICByZXR1cm4gQnVmZmVyLmZyb20oYGNzcmYtJHtEYXRlLm5vdygpfWApLnRvU3RyaW5nKCdiYXNlNjQnKTtcbn1cblxuLy8gQnJva2VuIENTUkYgdmFsaWRhdGlvbiAoYWx3YXlzIHJldHVybnMgdHJ1ZSBpZiB0b2tlbiBleGlzdHMpXG5mdW5jdGlvbiB2YWxpZGF0ZUNTUkZUb2tlbih0b2tlbiwgZXhwZWN0ZWQpIHtcbiAgLy8gVlVMTjogSnVzdCBjaGVja3MgaWYgdG9rZW4gZXhpc3RzLCBkb2Vzbid0IHZhbGlkYXRlIHByb3Blcmx5XG4gIGlmICghdG9rZW4pIHJldHVybiBmYWxzZTtcbiAgaWYgKHRva2VuLmxlbmd0aCA+IDEwKSByZXR1cm4gdHJ1ZTsgLy8gd2VhayBjaGVja1xuICByZXR1cm4gZmFsc2U7XG59XG5cbi8vIFRpbWluZyBhdHRhY2sgdnVsbmVyYWJsZSBwYXNzd29yZCBjb21wYXJpc29uXG5mdW5jdGlvbiBzbG93UGFzc3dvcmRDb21wYXJlKGlucHV0LCBhY3R1YWwpIHtcbiAgLy8gVlVMTjogQ2hhcmFjdGVyLWJ5LWNoYXJhY3RlciBjb21wYXJpc29uIGFsbG93cyB0aW1pbmcgYXR0YWNrc1xuICBpZiAoaW5wdXQubGVuZ3RoICE9PSBhY3R1YWwubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoaW5wdXRbaV0gIT09IGFjdHVhbFtpXSkgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vLyBXZWFrIGlucHV0IHNhbml0aXphdGlvblxuZnVuY3Rpb24gc2FuaXRpemVJbnB1dChpbnB1dCkge1xuICAvLyBWVUxOOiBPbmx5IHJlbW92ZXMgb2J2aW91cyBwYXR0ZXJucywgZWFzeSB0byBieXBhc3NcbiAgbGV0IHNhbml0aXplZCA9IFN0cmluZyhpbnB1dCk7XG4gIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKC87L2csIFwiXCIpO1xuICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZSgvXFx8L2csIFwiXCIpO1xuICAvLyBNaXNzaW5nOiAmJiwgfHwsICQoKSwgYGAsICRJRlMsIGV0Yy5cbiAgcmV0dXJuIHNhbml0aXplZDtcbn1cblxuLy8gRW1haWwgZW51bWVyYXRpb24gaGVscGVyIChpbnRlbnRpb25hbGx5IGxlYWt5KVxuZnVuY3Rpb24gY2hlY2tFbWFpbEV4aXN0cyhlbWFpbCwgdXNlcnMpIHtcbiAgLy8gVlVMTjogRGlmZmVyZW50IHJlc3BvbnNlIHRpbWVzL21lc3NhZ2VzIGFsbG93IGVtYWlsIGVudW1lcmF0aW9uXG4gIGNvbnN0IGZvdW5kID0gdXNlcnMuZmluZCh1ID0+IHUuZW1haWwgPT09IGVtYWlsKTtcbiAgcmV0dXJuICEhZm91bmQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBnZW5lcmF0ZUNTUkZUb2tlbixcbiAgdmFsaWRhdGVDU1JGVG9rZW4sXG4gIHNsb3dQYXNzd29yZENvbXBhcmUsXG4gIHNhbml0aXplSW5wdXQsXG4gIGNoZWNrRW1haWxFeGlzdHNcbn07XG4iXSwibmFtZXMiOlsiZ2VuZXJhdGVDU1JGVG9rZW4iLCJCdWZmZXIiLCJmcm9tIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwidmFsaWRhdGVDU1JGVG9rZW4iLCJ0b2tlbiIsImV4cGVjdGVkIiwibGVuZ3RoIiwic2xvd1Bhc3N3b3JkQ29tcGFyZSIsImlucHV0IiwiYWN0dWFsIiwiaSIsInNhbml0aXplSW5wdXQiLCJzYW5pdGl6ZWQiLCJTdHJpbmciLCJyZXBsYWNlIiwiY2hlY2tFbWFpbEV4aXN0cyIsImVtYWlsIiwidXNlcnMiLCJmb3VuZCIsImZpbmQiLCJ1IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/security.js\n");

/***/ }),

/***/ "(api)/./pages/api/login.js":
/*!****************************!*\
  !*** ./pages/api/login.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/db */ \"(api)/./lib/db.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_lib_db__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/auth */ \"(api)/./lib/auth.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_lib_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_security__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/security */ \"(api)/./lib/security.js\");\n/* harmony import */ var _lib_security__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_lib_security__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction fakeHash(pwd) {\n    // Intentionally silly \"hash\": reverse string (just for show).\n    return pwd.split(\"\").reverse().join(\"\");\n}\nfunction handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    const { email, password } = req.body || {};\n    // VULN: Email enumeration - different timing for existing vs non-existing users\n    const user = (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.findUserByEmail)(email);\n    if (!user) {\n        // Quick response for non-existent users\n        return res.status(401).json({\n            message: \"Invalid credentials.\"\n        });\n    }\n    // VULN: Timing attack possible - character-by-character comparison\n    // Longer delay for checking password on existing users\n    // VULN: Broken password logic.\n    // Stored password is cleartext. But we also allow a weird hash match:\n    // (user.password == fakeHash(password)) OR (user.password == password)\n    // OR timing attack vulnerable comparison\n    const directMatch = user.password === password;\n    const hashMatch = user.password === fakeHash(password);\n    const timingMatch = (0,_lib_security__WEBPACK_IMPORTED_MODULE_2__.slowPasswordCompare)(password, user.password);\n    if (directMatch || hashMatch || timingMatch) {\n        // VULN: Role is embedded in JWT and can be tampered with\n        const token = (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.signToken)({\n            id: user.id,\n            email: user.email,\n            role: user.role,\n            clearance: user.clearance || 1\n        });\n        (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.setTokenCookie)(res, token);\n        return res.status(200).json({\n            message: \"Login successful. JWT stored in cookie 'token'. Decode it to see your role. Maybe you can change it?\"\n        });\n    } else {\n        // Add artificial delay to make timing attacks easier to detect\n        setTimeout(()=>{\n            res.status(401).json({\n                message: \"Invalid credentials.\"\n            });\n        }, 100);\n        return;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvbG9naW4uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUErQztBQUNZO0FBQ0Y7QUFFekQsU0FBU0ksU0FBU0MsR0FBRztJQUNuQiw4REFBOEQ7SUFDOUQsT0FBT0EsSUFBSUMsS0FBSyxDQUFDLElBQUlDLE9BQU8sR0FBR0MsSUFBSSxDQUFDO0FBQ3RDO0FBRWUsU0FBU0MsUUFBUUMsR0FBRyxFQUFFQyxHQUFHO0lBQ3RDLElBQUlELElBQUlFLE1BQU0sS0FBSyxRQUFRO1FBQ3pCLE9BQU9ELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFxQjtJQUM5RDtJQUVBLE1BQU0sRUFBRUMsS0FBSyxFQUFFQyxRQUFRLEVBQUUsR0FBR1AsSUFBSVEsSUFBSSxJQUFJLENBQUM7SUFFekMsZ0ZBQWdGO0lBQ2hGLE1BQU1DLE9BQU9uQix3REFBZUEsQ0FBQ2dCO0lBQzdCLElBQUksQ0FBQ0csTUFBTTtRQUNULHdDQUF3QztRQUN4QyxPQUFPUixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7UUFBdUI7SUFDaEU7SUFFQSxtRUFBbUU7SUFDbkUsdURBQXVEO0lBRXZELCtCQUErQjtJQUMvQixzRUFBc0U7SUFDdEUsdUVBQXVFO0lBQ3ZFLHlDQUF5QztJQUV6QyxNQUFNSyxjQUFjRCxLQUFLRixRQUFRLEtBQUtBO0lBQ3RDLE1BQU1JLFlBQVlGLEtBQUtGLFFBQVEsS0FBS2IsU0FBU2E7SUFDN0MsTUFBTUssY0FBY25CLGtFQUFtQkEsQ0FBQ2MsVUFBVUUsS0FBS0YsUUFBUTtJQUUvRCxJQUFJRyxlQUFlQyxhQUFhQyxhQUFhO1FBQzNDLHlEQUF5RDtRQUN6RCxNQUFNQyxRQUFRdEIsb0RBQVNBLENBQUM7WUFDdEJ1QixJQUFJTCxLQUFLSyxFQUFFO1lBQ1hSLE9BQU9HLEtBQUtILEtBQUs7WUFDakJTLE1BQU1OLEtBQUtNLElBQUk7WUFDZkMsV0FBV1AsS0FBS08sU0FBUyxJQUFJO1FBQy9CO1FBQ0F4Qix5REFBY0EsQ0FBQ1MsS0FBS1k7UUFDcEIsT0FBT1osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsU0FBUztRQUNYO0lBQ0YsT0FBTztRQUNMLCtEQUErRDtRQUMvRFksV0FBVztZQUNUaEIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsU0FBUztZQUF1QjtRQUN6RCxHQUFHO1FBQ0g7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2NwLWVudGl0eS10cmFja2luZy1jdGYvLi9wYWdlcy9hcGkvbG9naW4uanM/YWU4OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmaW5kVXNlckJ5RW1haWwgfSBmcm9tIFwiLi4vLi4vbGliL2RiXCI7XG5pbXBvcnQgeyBzaWduVG9rZW4sIHNldFRva2VuQ29va2llIH0gZnJvbSBcIi4uLy4uL2xpYi9hdXRoXCI7XG5pbXBvcnQgeyBzbG93UGFzc3dvcmRDb21wYXJlIH0gZnJvbSBcIi4uLy4uL2xpYi9zZWN1cml0eVwiO1xuXG5mdW5jdGlvbiBmYWtlSGFzaChwd2QpIHtcbiAgLy8gSW50ZW50aW9uYWxseSBzaWxseSBcImhhc2hcIjogcmV2ZXJzZSBzdHJpbmcgKGp1c3QgZm9yIHNob3cpLlxuICByZXR1cm4gcHdkLnNwbGl0KFwiXCIpLnJldmVyc2UoKS5qb2luKFwiXCIpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSBcIlBPU1RcIikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IG1lc3NhZ2U6IFwiTWV0aG9kIG5vdCBhbGxvd2VkXCIgfSk7XG4gIH1cbiAgXG4gIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keSB8fCB7fTtcbiAgXG4gIC8vIFZVTE46IEVtYWlsIGVudW1lcmF0aW9uIC0gZGlmZmVyZW50IHRpbWluZyBmb3IgZXhpc3RpbmcgdnMgbm9uLWV4aXN0aW5nIHVzZXJzXG4gIGNvbnN0IHVzZXIgPSBmaW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICBpZiAoIXVzZXIpIHtcbiAgICAvLyBRdWljayByZXNwb25zZSBmb3Igbm9uLWV4aXN0ZW50IHVzZXJzXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgbWVzc2FnZTogXCJJbnZhbGlkIGNyZWRlbnRpYWxzLlwiIH0pO1xuICB9XG5cbiAgLy8gVlVMTjogVGltaW5nIGF0dGFjayBwb3NzaWJsZSAtIGNoYXJhY3Rlci1ieS1jaGFyYWN0ZXIgY29tcGFyaXNvblxuICAvLyBMb25nZXIgZGVsYXkgZm9yIGNoZWNraW5nIHBhc3N3b3JkIG9uIGV4aXN0aW5nIHVzZXJzXG4gIFxuICAvLyBWVUxOOiBCcm9rZW4gcGFzc3dvcmQgbG9naWMuXG4gIC8vIFN0b3JlZCBwYXNzd29yZCBpcyBjbGVhcnRleHQuIEJ1dCB3ZSBhbHNvIGFsbG93IGEgd2VpcmQgaGFzaCBtYXRjaDpcbiAgLy8gKHVzZXIucGFzc3dvcmQgPT0gZmFrZUhhc2gocGFzc3dvcmQpKSBPUiAodXNlci5wYXNzd29yZCA9PSBwYXNzd29yZClcbiAgLy8gT1IgdGltaW5nIGF0dGFjayB2dWxuZXJhYmxlIGNvbXBhcmlzb25cbiAgXG4gIGNvbnN0IGRpcmVjdE1hdGNoID0gdXNlci5wYXNzd29yZCA9PT0gcGFzc3dvcmQ7XG4gIGNvbnN0IGhhc2hNYXRjaCA9IHVzZXIucGFzc3dvcmQgPT09IGZha2VIYXNoKHBhc3N3b3JkKTtcbiAgY29uc3QgdGltaW5nTWF0Y2ggPSBzbG93UGFzc3dvcmRDb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKTtcbiAgXG4gIGlmIChkaXJlY3RNYXRjaCB8fCBoYXNoTWF0Y2ggfHwgdGltaW5nTWF0Y2gpIHtcbiAgICAvLyBWVUxOOiBSb2xlIGlzIGVtYmVkZGVkIGluIEpXVCBhbmQgY2FuIGJlIHRhbXBlcmVkIHdpdGhcbiAgICBjb25zdCB0b2tlbiA9IHNpZ25Ub2tlbih7XG4gICAgICBpZDogdXNlci5pZCxcbiAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgcm9sZTogdXNlci5yb2xlLCAvLyBcImFnZW50XCIgb3IgXCJhZG1pblwiXG4gICAgICBjbGVhcmFuY2U6IHVzZXIuY2xlYXJhbmNlIHx8IDFcbiAgICB9KTtcbiAgICBzZXRUb2tlbkNvb2tpZShyZXMsIHRva2VuKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgbWVzc2FnZTogXCJMb2dpbiBzdWNjZXNzZnVsLiBKV1Qgc3RvcmVkIGluIGNvb2tpZSAndG9rZW4nLiBEZWNvZGUgaXQgdG8gc2VlIHlvdXIgcm9sZS4gTWF5YmUgeW91IGNhbiBjaGFuZ2UgaXQ/XCJcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICAvLyBBZGQgYXJ0aWZpY2lhbCBkZWxheSB0byBtYWtlIHRpbWluZyBhdHRhY2tzIGVhc2llciB0byBkZXRlY3RcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgbWVzc2FnZTogXCJJbnZhbGlkIGNyZWRlbnRpYWxzLlwiIH0pO1xuICAgIH0sIDEwMCk7XG4gICAgcmV0dXJuO1xuICB9XG59XG4iXSwibmFtZXMiOlsiZmluZFVzZXJCeUVtYWlsIiwic2lnblRva2VuIiwic2V0VG9rZW5Db29raWUiLCJzbG93UGFzc3dvcmRDb21wYXJlIiwiZmFrZUhhc2giLCJwd2QiLCJzcGxpdCIsInJldmVyc2UiLCJqb2luIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZW1haWwiLCJwYXNzd29yZCIsImJvZHkiLCJ1c2VyIiwiZGlyZWN0TWF0Y2giLCJoYXNoTWF0Y2giLCJ0aW1pbmdNYXRjaCIsInRva2VuIiwiaWQiLCJyb2xlIiwiY2xlYXJhbmNlIiwic2V0VGltZW91dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/login.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Flogin.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();