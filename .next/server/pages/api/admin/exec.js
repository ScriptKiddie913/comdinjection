"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/admin/exec";
exports.ids = ["pages/api/admin/exec"];
exports.modules = {

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fexec&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fadmin%2Fexec.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fexec&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fadmin%2Fexec.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_admin_exec_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/admin/exec.js */ \"(api)/./pages/api/admin/exec.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_admin_exec_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_admin_exec_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/admin/exec\",\n        pathname: \"/api/admin/exec\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_admin_exec_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmFkbWluJTJGZXhlYyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGYWRtaW4lMkZleGVjLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3NEO0FBQ3REO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxxREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMscURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2NwLWVudGl0eS10cmFja2luZy1jdGYvPzMxODkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9hZG1pbi9leGVjLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWRtaW4vZXhlY1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FkbWluL2V4ZWNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fexec&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fadmin%2Fexec.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/auth.js":
/*!*********************!*\
  !*** ./lib/auth.js ***!
  \*********************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nconst cookie = __webpack_require__(/*! cookie */ \"cookie\");\n// Weak secret â€“ leaked in source (vuln).\nconst JWT_SECRET = \"scpsecret\";\n// Vulnerable: We also accept 'none' algorithm and don't verify properly in some places.\nfunction signToken(payload) {\n    return jwt.sign(payload, JWT_SECRET, {\n        algorithm: \"HS256\",\n        expiresIn: \"2h\"\n    });\n}\n// Proper verification (but some endpoints will skip it intentionally).\nfunction verifyToken(token) {\n    try {\n        return jwt.verify(token, JWT_SECRET, {\n            algorithms: [\n                \"HS256\"\n            ]\n        });\n    } catch (e) {\n        return null;\n    }\n}\n// VULN: Insecure verification that accepts 'none' algorithm\nfunction insecureVerifyToken(token) {\n    try {\n        // This accepts tokens with no signature (algorithm: 'none')\n        return jwt.verify(token, JWT_SECRET, {\n            algorithms: [\n                \"HS256\",\n                \"none\"\n            ]\n        });\n    } catch (e) {\n        // If standard verification fails, try decoding anyway\n        return unsafeDecode(token);\n    }\n}\n// Insecure: decode without verification (for role checks in some places).\nfunction unsafeDecode(token) {\n    try {\n        return jwt.decode(token, {\n            complete: false\n        });\n    } catch (e) {\n        return null;\n    }\n}\n// VULN: Weak secret allows easy brute-forcing\nfunction canBruteForce() {\n    // The secret \"scpsecret\" is weak and visible in source\n    // It can be cracked with tools like john or hashcat\n    return true;\n}\nfunction getTokenFromReq(req) {\n    const cookies = req.headers.cookie ? cookie.parse(req.headers.cookie || \"\") : {};\n    return cookies[\"token\"] || null;\n}\nfunction setTokenCookie(res, token) {\n    const header = cookie.serialize(\"token\", token, {\n        httpOnly: false,\n        secure: false,\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 7200 // 2 hours\n    });\n    res.setHeader(\"Set-Cookie\", header);\n}\nfunction clearTokenCookie(res) {\n    const header = cookie.serialize(\"token\", \"\", {\n        httpOnly: false,\n        secure: false,\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 0\n    });\n    res.setHeader(\"Set-Cookie\", header);\n}\nmodule.exports = {\n    JWT_SECRET,\n    signToken,\n    verifyToken,\n    insecureVerifyToken,\n    unsafeDecode,\n    getTokenFromReq,\n    setTokenCookie,\n    clearTokenCookie\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC5qcyIsIm1hcHBpbmdzIjoiO0FBQUEsTUFBTUEsTUFBTUMsbUJBQU9BLENBQUMsa0NBQWM7QUFDbEMsTUFBTUMsU0FBU0QsbUJBQU9BLENBQUMsc0JBQVE7QUFFL0IseUNBQXlDO0FBQ3pDLE1BQU1FLGFBQWE7QUFFbkIsd0ZBQXdGO0FBQ3hGLFNBQVNDLFVBQVVDLE9BQU87SUFDeEIsT0FBT0wsSUFBSU0sSUFBSSxDQUFDRCxTQUFTRixZQUFZO1FBQUVJLFdBQVc7UUFBU0MsV0FBVztJQUFLO0FBQzdFO0FBRUEsdUVBQXVFO0FBQ3ZFLFNBQVNDLFlBQVlDLEtBQUs7SUFDeEIsSUFBSTtRQUNGLE9BQU9WLElBQUlXLE1BQU0sQ0FBQ0QsT0FBT1AsWUFBWTtZQUFFUyxZQUFZO2dCQUFDO2FBQVE7UUFBQztJQUMvRCxFQUFFLE9BQU9DLEdBQUc7UUFDVixPQUFPO0lBQ1Q7QUFDRjtBQUVBLDREQUE0RDtBQUM1RCxTQUFTQyxvQkFBb0JKLEtBQUs7SUFDaEMsSUFBSTtRQUNGLDREQUE0RDtRQUM1RCxPQUFPVixJQUFJVyxNQUFNLENBQUNELE9BQU9QLFlBQVk7WUFBRVMsWUFBWTtnQkFBQztnQkFBUzthQUFPO1FBQUM7SUFDdkUsRUFBRSxPQUFPQyxHQUFHO1FBQ1Ysc0RBQXNEO1FBQ3RELE9BQU9FLGFBQWFMO0lBQ3RCO0FBQ0Y7QUFFQSwwRUFBMEU7QUFDMUUsU0FBU0ssYUFBYUwsS0FBSztJQUN6QixJQUFJO1FBQ0YsT0FBT1YsSUFBSWdCLE1BQU0sQ0FBQ04sT0FBTztZQUFFTyxVQUFVO1FBQU07SUFDN0MsRUFBRSxPQUFPSixHQUFHO1FBQ1YsT0FBTztJQUNUO0FBQ0Y7QUFFQSw4Q0FBOEM7QUFDOUMsU0FBU0s7SUFDUCx1REFBdUQ7SUFDdkQsb0RBQW9EO0lBQ3BELE9BQU87QUFDVDtBQUVBLFNBQVNDLGdCQUFnQkMsR0FBRztJQUMxQixNQUFNQyxVQUFVRCxJQUFJRSxPQUFPLENBQUNwQixNQUFNLEdBQzlCQSxPQUFPcUIsS0FBSyxDQUFDSCxJQUFJRSxPQUFPLENBQUNwQixNQUFNLElBQUksTUFDbkMsQ0FBQztJQUNMLE9BQU9tQixPQUFPLENBQUMsUUFBUSxJQUFJO0FBQzdCO0FBRUEsU0FBU0csZUFBZUMsR0FBRyxFQUFFZixLQUFLO0lBQ2hDLE1BQU1nQixTQUFTeEIsT0FBT3lCLFNBQVMsQ0FBQyxTQUFTakIsT0FBTztRQUM5Q2tCLFVBQVU7UUFDVkMsUUFBUTtRQUNSQyxVQUFVO1FBQ1ZDLE1BQU07UUFDTkMsUUFBUSxLQUFLLFVBQVU7SUFDekI7SUFDQVAsSUFBSVEsU0FBUyxDQUFDLGNBQWNQO0FBQzlCO0FBRUEsU0FBU1EsaUJBQWlCVCxHQUFHO0lBQzNCLE1BQU1DLFNBQVN4QixPQUFPeUIsU0FBUyxDQUFDLFNBQVMsSUFBSTtRQUMzQ0MsVUFBVTtRQUNWQyxRQUFRO1FBQ1JDLFVBQVU7UUFDVkMsTUFBTTtRQUNOQyxRQUFRO0lBQ1Y7SUFDQVAsSUFBSVEsU0FBUyxDQUFDLGNBQWNQO0FBQzlCO0FBRUFTLE9BQU9DLE9BQU8sR0FBRztJQUNmakM7SUFDQUM7SUFDQUs7SUFDQUs7SUFDQUM7SUFDQUk7SUFDQUs7SUFDQVU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NjcC1lbnRpdHktdHJhY2tpbmctY3RmLy4vbGliL2F1dGguanM/Mjg3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xuY29uc3QgY29va2llID0gcmVxdWlyZShcImNvb2tpZVwiKTtcblxuLy8gV2VhayBzZWNyZXQg4oCTIGxlYWtlZCBpbiBzb3VyY2UgKHZ1bG4pLlxuY29uc3QgSldUX1NFQ1JFVCA9IFwic2Nwc2VjcmV0XCI7XG5cbi8vIFZ1bG5lcmFibGU6IFdlIGFsc28gYWNjZXB0ICdub25lJyBhbGdvcml0aG0gYW5kIGRvbid0IHZlcmlmeSBwcm9wZXJseSBpbiBzb21lIHBsYWNlcy5cbmZ1bmN0aW9uIHNpZ25Ub2tlbihwYXlsb2FkKSB7XG4gIHJldHVybiBqd3Quc2lnbihwYXlsb2FkLCBKV1RfU0VDUkVULCB7IGFsZ29yaXRobTogXCJIUzI1NlwiLCBleHBpcmVzSW46IFwiMmhcIiB9KTtcbn1cblxuLy8gUHJvcGVyIHZlcmlmaWNhdGlvbiAoYnV0IHNvbWUgZW5kcG9pbnRzIHdpbGwgc2tpcCBpdCBpbnRlbnRpb25hbGx5KS5cbmZ1bmN0aW9uIHZlcmlmeVRva2VuKHRva2VuKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4sIEpXVF9TRUNSRVQsIHsgYWxnb3JpdGhtczogW1wiSFMyNTZcIl0gfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyBWVUxOOiBJbnNlY3VyZSB2ZXJpZmljYXRpb24gdGhhdCBhY2NlcHRzICdub25lJyBhbGdvcml0aG1cbmZ1bmN0aW9uIGluc2VjdXJlVmVyaWZ5VG9rZW4odG9rZW4pIHtcbiAgdHJ5IHtcbiAgICAvLyBUaGlzIGFjY2VwdHMgdG9rZW5zIHdpdGggbm8gc2lnbmF0dXJlIChhbGdvcml0aG06ICdub25lJylcbiAgICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCwgeyBhbGdvcml0aG1zOiBbXCJIUzI1NlwiLCBcIm5vbmVcIl0gfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBJZiBzdGFuZGFyZCB2ZXJpZmljYXRpb24gZmFpbHMsIHRyeSBkZWNvZGluZyBhbnl3YXlcbiAgICByZXR1cm4gdW5zYWZlRGVjb2RlKHRva2VuKTtcbiAgfVxufVxuXG4vLyBJbnNlY3VyZTogZGVjb2RlIHdpdGhvdXQgdmVyaWZpY2F0aW9uIChmb3Igcm9sZSBjaGVja3MgaW4gc29tZSBwbGFjZXMpLlxuZnVuY3Rpb24gdW5zYWZlRGVjb2RlKHRva2VuKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGp3dC5kZWNvZGUodG9rZW4sIHsgY29tcGxldGU6IGZhbHNlIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gVlVMTjogV2VhayBzZWNyZXQgYWxsb3dzIGVhc3kgYnJ1dGUtZm9yY2luZ1xuZnVuY3Rpb24gY2FuQnJ1dGVGb3JjZSgpIHtcbiAgLy8gVGhlIHNlY3JldCBcInNjcHNlY3JldFwiIGlzIHdlYWsgYW5kIHZpc2libGUgaW4gc291cmNlXG4gIC8vIEl0IGNhbiBiZSBjcmFja2VkIHdpdGggdG9vbHMgbGlrZSBqb2huIG9yIGhhc2hjYXRcbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGdldFRva2VuRnJvbVJlcShyZXEpIHtcbiAgY29uc3QgY29va2llcyA9IHJlcS5oZWFkZXJzLmNvb2tpZVxuICAgID8gY29va2llLnBhcnNlKHJlcS5oZWFkZXJzLmNvb2tpZSB8fCBcIlwiKVxuICAgIDoge307XG4gIHJldHVybiBjb29raWVzW1widG9rZW5cIl0gfHwgbnVsbDtcbn1cblxuZnVuY3Rpb24gc2V0VG9rZW5Db29raWUocmVzLCB0b2tlbikge1xuICBjb25zdCBoZWFkZXIgPSBjb29raWUuc2VyaWFsaXplKFwidG9rZW5cIiwgdG9rZW4sIHtcbiAgICBodHRwT25seTogZmFsc2UsIC8vIHZ1bG46IEpTIGFjY2Vzc2libGVcbiAgICBzZWN1cmU6IGZhbHNlLCAgIC8vIHZ1bG46IHdvcmtzIG92ZXIgSFRUUFxuICAgIHNhbWVTaXRlOiBcImxheFwiLCAvLyB2dWxuOiBDU1JGLXByb25lIChub3QgJ3N0cmljdCcpXG4gICAgcGF0aDogXCIvXCIsXG4gICAgbWF4QWdlOiA3MjAwIC8vIDIgaG91cnNcbiAgfSk7XG4gIHJlcy5zZXRIZWFkZXIoXCJTZXQtQ29va2llXCIsIGhlYWRlcik7XG59XG5cbmZ1bmN0aW9uIGNsZWFyVG9rZW5Db29raWUocmVzKSB7XG4gIGNvbnN0IGhlYWRlciA9IGNvb2tpZS5zZXJpYWxpemUoXCJ0b2tlblwiLCBcIlwiLCB7XG4gICAgaHR0cE9ubHk6IGZhbHNlLFxuICAgIHNlY3VyZTogZmFsc2UsXG4gICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gICAgcGF0aDogXCIvXCIsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xuICByZXMuc2V0SGVhZGVyKFwiU2V0LUNvb2tpZVwiLCBoZWFkZXIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgSldUX1NFQ1JFVCxcbiAgc2lnblRva2VuLFxuICB2ZXJpZnlUb2tlbixcbiAgaW5zZWN1cmVWZXJpZnlUb2tlbixcbiAgdW5zYWZlRGVjb2RlLFxuICBnZXRUb2tlbkZyb21SZXEsXG4gIHNldFRva2VuQ29va2llLFxuICBjbGVhclRva2VuQ29va2llXG59O1xuIl0sIm5hbWVzIjpbImp3dCIsInJlcXVpcmUiLCJjb29raWUiLCJKV1RfU0VDUkVUIiwic2lnblRva2VuIiwicGF5bG9hZCIsInNpZ24iLCJhbGdvcml0aG0iLCJleHBpcmVzSW4iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwidmVyaWZ5IiwiYWxnb3JpdGhtcyIsImUiLCJpbnNlY3VyZVZlcmlmeVRva2VuIiwidW5zYWZlRGVjb2RlIiwiZGVjb2RlIiwiY29tcGxldGUiLCJjYW5CcnV0ZUZvcmNlIiwiZ2V0VG9rZW5Gcm9tUmVxIiwicmVxIiwiY29va2llcyIsImhlYWRlcnMiLCJwYXJzZSIsInNldFRva2VuQ29va2llIiwicmVzIiwiaGVhZGVyIiwic2VyaWFsaXplIiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsInBhdGgiLCJtYXhBZ2UiLCJzZXRIZWFkZXIiLCJjbGVhclRva2VuQ29va2llIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/auth.js\n");

/***/ }),

/***/ "(api)/./pages/api/admin/exec.js":
/*!*********************************!*\
  !*** ./pages/api/admin/exec.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/auth */ \"(api)/./lib/auth.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_lib_auth__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// VULN: command injection on `target` with weak filtering.\nfunction handler(req, res) {\n    const token = (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getTokenFromReq)(req);\n    if (!token) {\n        return res.status(401).json({\n            error: \"Not authenticated.\"\n        });\n    }\n    // VULN: Uses unsafeDecode - no signature verification\n    // This means JWT can be tampered with to set role=\"admin\"\n    const decoded = (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.unsafeDecode)(token);\n    if (!decoded || decoded.role !== \"admin\") {\n        return res.status(403).json({\n            error: \"Admin role required. Check your JWT token - maybe you can modify it?\"\n        });\n    }\n    const target = req.query.target || \"127.0.0.1\";\n    // VULN: Extremely weak input \"sanitization\"\n    // Only blocks semicolons - many bypass techniques available:\n    // - && (AND operator): 127.0.0.1&&cat${IFS}/flag.txt\n    // - || (OR operator): invalidhost||cat${IFS}/flag.txt\n    // - Backticks: 127.0.0.1`cat /flag.txt`\n    // - $() command substitution: 127.0.0.1$(cat /flag.txt)\n    // - $IFS for space bypass: cat${IFS}/flag.txt\n    // - Newlines: %0a for command chaining\n    // - Pipes with space alternatives: cat</flag.txt\n    let sanitized = String(target);\n    sanitized = sanitized.replace(/;/g, \"\"); // Only removes semicolons!\n    // Still vulnerable to: &&, ||, |, `, $(), ${IFS}, %0a, etc.\n    const cmd = `ping -c 1 ${sanitized}`;\n    (0,child_process__WEBPACK_IMPORTED_MODULE_0__.exec)(cmd, {\n        timeout: 5000\n    }, (err, stdout, stderr)=>{\n        if (err) {\n            // VULN: Error output might contain command execution results\n            return res.status(200).json({\n                output: \"Command executed with errors (useful for blind injection):\\n\" + stdout + \"\\n\" + stderr + \"\\n\\nTip: Try bypassing with &&, ||, backticks, or $IFS\"\n            });\n        }\n        return res.status(200).json({\n            output: stdout || stderr || \"No output.\",\n            hint: \"Filter only blocks semicolons. Try: 127.0.0.1&&cat${IFS}/flag.txt\"\n        });\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYWRtaW4vZXhlYy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFxQztBQUM2QjtBQUVsRSwyREFBMkQ7QUFDNUMsU0FBU0csUUFBUUMsR0FBRyxFQUFFQyxHQUFHO0lBQ3RDLE1BQU1DLFFBQVFMLDBEQUFlQSxDQUFDRztJQUM5QixJQUFJLENBQUNFLE9BQU87UUFDVixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBcUI7SUFDNUQ7SUFFQSxzREFBc0Q7SUFDdEQsMERBQTBEO0lBQzFELE1BQU1DLFVBQVVSLHVEQUFZQSxDQUFDSTtJQUM3QixJQUFJLENBQUNJLFdBQVdBLFFBQVFDLElBQUksS0FBSyxTQUFTO1FBQ3hDLE9BQU9OLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJDLE9BQU87UUFDVDtJQUNGO0lBRUEsTUFBTUcsU0FBU1IsSUFBSVMsS0FBSyxDQUFDRCxNQUFNLElBQUk7SUFFbkMsNENBQTRDO0lBQzVDLDZEQUE2RDtJQUM3RCxxREFBcUQ7SUFDckQsc0RBQXNEO0lBQ3RELHdDQUF3QztJQUN4Qyx3REFBd0Q7SUFDeEQsOENBQThDO0lBQzlDLHVDQUF1QztJQUN2QyxpREFBaUQ7SUFFakQsSUFBSUUsWUFBWUMsT0FBT0g7SUFDdkJFLFlBQVlBLFVBQVVFLE9BQU8sQ0FBQyxNQUFNLEtBQUssMkJBQTJCO0lBRXBFLDREQUE0RDtJQUU1RCxNQUFNQyxNQUFNLENBQUMsVUFBVSxFQUFFSCxVQUFVLENBQUM7SUFFcENkLG1EQUFJQSxDQUFDaUIsS0FBSztRQUFFQyxTQUFTO0lBQUssR0FBRyxDQUFDQyxLQUFLQyxRQUFRQztRQUN6QyxJQUFJRixLQUFLO1lBQ1AsNkRBQTZEO1lBQzdELE9BQU9kLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQzFCYyxRQUNFLGlFQUNBRixTQUNBLE9BQ0FDLFNBQ0E7WUFDSjtRQUNGO1FBQ0EsT0FBT2hCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJjLFFBQVFGLFVBQVVDLFVBQVU7WUFDNUJFLE1BQU07UUFDUjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY3AtZW50aXR5LXRyYWNraW5nLWN0Zi8uL3BhZ2VzL2FwaS9hZG1pbi9leGVjLmpzPzc0NTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhlYyB9IGZyb20gXCJjaGlsZF9wcm9jZXNzXCI7XG5pbXBvcnQgeyBnZXRUb2tlbkZyb21SZXEsIHVuc2FmZURlY29kZSB9IGZyb20gXCIuLi8uLi8uLi9saWIvYXV0aFwiO1xuXG4vLyBWVUxOOiBjb21tYW5kIGluamVjdGlvbiBvbiBgdGFyZ2V0YCB3aXRoIHdlYWsgZmlsdGVyaW5nLlxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICBjb25zdCB0b2tlbiA9IGdldFRva2VuRnJvbVJlcShyZXEpO1xuICBpZiAoIXRva2VuKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6IFwiTm90IGF1dGhlbnRpY2F0ZWQuXCIgfSk7XG4gIH1cblxuICAvLyBWVUxOOiBVc2VzIHVuc2FmZURlY29kZSAtIG5vIHNpZ25hdHVyZSB2ZXJpZmljYXRpb25cbiAgLy8gVGhpcyBtZWFucyBKV1QgY2FuIGJlIHRhbXBlcmVkIHdpdGggdG8gc2V0IHJvbGU9XCJhZG1pblwiXG4gIGNvbnN0IGRlY29kZWQgPSB1bnNhZmVEZWNvZGUodG9rZW4pO1xuICBpZiAoIWRlY29kZWQgfHwgZGVjb2RlZC5yb2xlICE9PSBcImFkbWluXCIpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBcbiAgICAgIGVycm9yOiBcIkFkbWluIHJvbGUgcmVxdWlyZWQuIENoZWNrIHlvdXIgSldUIHRva2VuIC0gbWF5YmUgeW91IGNhbiBtb2RpZnkgaXQ/XCIgXG4gICAgfSk7XG4gIH1cblxuICBjb25zdCB0YXJnZXQgPSByZXEucXVlcnkudGFyZ2V0IHx8IFwiMTI3LjAuMC4xXCI7XG5cbiAgLy8gVlVMTjogRXh0cmVtZWx5IHdlYWsgaW5wdXQgXCJzYW5pdGl6YXRpb25cIlxuICAvLyBPbmx5IGJsb2NrcyBzZW1pY29sb25zIC0gbWFueSBieXBhc3MgdGVjaG5pcXVlcyBhdmFpbGFibGU6XG4gIC8vIC0gJiYgKEFORCBvcGVyYXRvcik6IDEyNy4wLjAuMSYmY2F0JHtJRlN9L2ZsYWcudHh0XG4gIC8vIC0gfHwgKE9SIG9wZXJhdG9yKTogaW52YWxpZGhvc3R8fGNhdCR7SUZTfS9mbGFnLnR4dFxuICAvLyAtIEJhY2t0aWNrczogMTI3LjAuMC4xYGNhdCAvZmxhZy50eHRgXG4gIC8vIC0gJCgpIGNvbW1hbmQgc3Vic3RpdHV0aW9uOiAxMjcuMC4wLjEkKGNhdCAvZmxhZy50eHQpXG4gIC8vIC0gJElGUyBmb3Igc3BhY2UgYnlwYXNzOiBjYXQke0lGU30vZmxhZy50eHRcbiAgLy8gLSBOZXdsaW5lczogJTBhIGZvciBjb21tYW5kIGNoYWluaW5nXG4gIC8vIC0gUGlwZXMgd2l0aCBzcGFjZSBhbHRlcm5hdGl2ZXM6IGNhdDwvZmxhZy50eHRcbiAgXG4gIGxldCBzYW5pdGl6ZWQgPSBTdHJpbmcodGFyZ2V0KTtcbiAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoLzsvZywgXCJcIik7IC8vIE9ubHkgcmVtb3ZlcyBzZW1pY29sb25zIVxuICBcbiAgLy8gU3RpbGwgdnVsbmVyYWJsZSB0bzogJiYsIHx8LCB8LCBgLCAkKCksICR7SUZTfSwgJTBhLCBldGMuXG5cbiAgY29uc3QgY21kID0gYHBpbmcgLWMgMSAke3Nhbml0aXplZH1gO1xuXG4gIGV4ZWMoY21kLCB7IHRpbWVvdXQ6IDUwMDAgfSwgKGVyciwgc3Rkb3V0LCBzdGRlcnIpID0+IHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICAvLyBWVUxOOiBFcnJvciBvdXRwdXQgbWlnaHQgY29udGFpbiBjb21tYW5kIGV4ZWN1dGlvbiByZXN1bHRzXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBvdXRwdXQ6XG4gICAgICAgICAgXCJDb21tYW5kIGV4ZWN1dGVkIHdpdGggZXJyb3JzICh1c2VmdWwgZm9yIGJsaW5kIGluamVjdGlvbik6XFxuXCIgK1xuICAgICAgICAgIHN0ZG91dCArXG4gICAgICAgICAgXCJcXG5cIiArXG4gICAgICAgICAgc3RkZXJyICtcbiAgICAgICAgICBcIlxcblxcblRpcDogVHJ5IGJ5cGFzc2luZyB3aXRoICYmLCB8fCwgYmFja3RpY2tzLCBvciAkSUZTXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBcbiAgICAgIG91dHB1dDogc3Rkb3V0IHx8IHN0ZGVyciB8fCBcIk5vIG91dHB1dC5cIixcbiAgICAgIGhpbnQ6IFwiRmlsdGVyIG9ubHkgYmxvY2tzIHNlbWljb2xvbnMuIFRyeTogMTI3LjAuMC4xJiZjYXQke0lGU30vZmxhZy50eHRcIlxuICAgIH0pO1xuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJleGVjIiwiZ2V0VG9rZW5Gcm9tUmVxIiwidW5zYWZlRGVjb2RlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInRva2VuIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiZGVjb2RlZCIsInJvbGUiLCJ0YXJnZXQiLCJxdWVyeSIsInNhbml0aXplZCIsIlN0cmluZyIsInJlcGxhY2UiLCJjbWQiLCJ0aW1lb3V0IiwiZXJyIiwic3Rkb3V0Iiwic3RkZXJyIiwib3V0cHV0IiwiaGludCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/admin/exec.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fexec&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fadmin%2Fexec.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();