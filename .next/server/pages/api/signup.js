"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/signup";
exports.ids = ["pages/api/signup"];
exports.modules = {

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsignup&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsignup.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsignup&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsignup.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_signup_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/signup.js */ \"(api)/./pages/api/signup.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_signup_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_signup_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/signup\",\n        pathname: \"/api/signup\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_signup_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNpZ251cCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGc2lnbnVwLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ2tEO0FBQ2xEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2NwLWVudGl0eS10cmFja2luZy1jdGYvPzY3MzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9zaWdudXAuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zaWdudXBcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zaWdudXBcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsignup&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsignup.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/auth.js":
/*!*********************!*\
  !*** ./lib/auth.js ***!
  \*********************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nconst cookie = __webpack_require__(/*! cookie */ \"cookie\");\n// Weak secret – leaked in source (vuln).\nconst JWT_SECRET = \"scpsecret\";\n// Vulnerable: We also accept 'none' algorithm and don't verify properly in some places.\nfunction signToken(payload) {\n    return jwt.sign(payload, JWT_SECRET, {\n        algorithm: \"HS256\",\n        expiresIn: \"2h\"\n    });\n}\n// Proper verification (but some endpoints will skip it intentionally).\nfunction verifyToken(token) {\n    try {\n        return jwt.verify(token, JWT_SECRET, {\n            algorithms: [\n                \"HS256\"\n            ]\n        });\n    } catch (e) {\n        return null;\n    }\n}\n// VULN: Insecure verification that accepts 'none' algorithm\nfunction insecureVerifyToken(token) {\n    try {\n        // This accepts tokens with no signature (algorithm: 'none')\n        return jwt.verify(token, JWT_SECRET, {\n            algorithms: [\n                \"HS256\",\n                \"none\"\n            ]\n        });\n    } catch (e) {\n        // If standard verification fails, try decoding anyway\n        return unsafeDecode(token);\n    }\n}\n// Insecure: decode without verification (for role checks in some places).\nfunction unsafeDecode(token) {\n    try {\n        return jwt.decode(token, {\n            complete: false\n        });\n    } catch (e) {\n        return null;\n    }\n}\n// VULN: Weak secret allows easy brute-forcing\nfunction canBruteForce() {\n    // The secret \"scpsecret\" is weak and visible in source\n    // It can be cracked with tools like john or hashcat\n    return true;\n}\nfunction getTokenFromReq(req) {\n    const cookies = req.headers.cookie ? cookie.parse(req.headers.cookie || \"\") : {};\n    return cookies[\"token\"] || null;\n}\nfunction setTokenCookie(res, token) {\n    const header = cookie.serialize(\"token\", token, {\n        httpOnly: false,\n        secure: false,\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 7200 // 2 hours\n    });\n    res.setHeader(\"Set-Cookie\", header);\n}\nfunction clearTokenCookie(res) {\n    const header = cookie.serialize(\"token\", \"\", {\n        httpOnly: false,\n        secure: false,\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 0\n    });\n    res.setHeader(\"Set-Cookie\", header);\n}\nmodule.exports = {\n    JWT_SECRET,\n    signToken,\n    verifyToken,\n    insecureVerifyToken,\n    unsafeDecode,\n    getTokenFromReq,\n    setTokenCookie,\n    clearTokenCookie\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC5qcyIsIm1hcHBpbmdzIjoiO0FBQUEsTUFBTUEsTUFBTUMsbUJBQU9BLENBQUMsa0NBQWM7QUFDbEMsTUFBTUMsU0FBU0QsbUJBQU9BLENBQUMsc0JBQVE7QUFFL0IseUNBQXlDO0FBQ3pDLE1BQU1FLGFBQWE7QUFFbkIsd0ZBQXdGO0FBQ3hGLFNBQVNDLFVBQVVDLE9BQU87SUFDeEIsT0FBT0wsSUFBSU0sSUFBSSxDQUFDRCxTQUFTRixZQUFZO1FBQUVJLFdBQVc7UUFBU0MsV0FBVztJQUFLO0FBQzdFO0FBRUEsdUVBQXVFO0FBQ3ZFLFNBQVNDLFlBQVlDLEtBQUs7SUFDeEIsSUFBSTtRQUNGLE9BQU9WLElBQUlXLE1BQU0sQ0FBQ0QsT0FBT1AsWUFBWTtZQUFFUyxZQUFZO2dCQUFDO2FBQVE7UUFBQztJQUMvRCxFQUFFLE9BQU9DLEdBQUc7UUFDVixPQUFPO0lBQ1Q7QUFDRjtBQUVBLDREQUE0RDtBQUM1RCxTQUFTQyxvQkFBb0JKLEtBQUs7SUFDaEMsSUFBSTtRQUNGLDREQUE0RDtRQUM1RCxPQUFPVixJQUFJVyxNQUFNLENBQUNELE9BQU9QLFlBQVk7WUFBRVMsWUFBWTtnQkFBQztnQkFBUzthQUFPO1FBQUM7SUFDdkUsRUFBRSxPQUFPQyxHQUFHO1FBQ1Ysc0RBQXNEO1FBQ3RELE9BQU9FLGFBQWFMO0lBQ3RCO0FBQ0Y7QUFFQSwwRUFBMEU7QUFDMUUsU0FBU0ssYUFBYUwsS0FBSztJQUN6QixJQUFJO1FBQ0YsT0FBT1YsSUFBSWdCLE1BQU0sQ0FBQ04sT0FBTztZQUFFTyxVQUFVO1FBQU07SUFDN0MsRUFBRSxPQUFPSixHQUFHO1FBQ1YsT0FBTztJQUNUO0FBQ0Y7QUFFQSw4Q0FBOEM7QUFDOUMsU0FBU0s7SUFDUCx1REFBdUQ7SUFDdkQsb0RBQW9EO0lBQ3BELE9BQU87QUFDVDtBQUVBLFNBQVNDLGdCQUFnQkMsR0FBRztJQUMxQixNQUFNQyxVQUFVRCxJQUFJRSxPQUFPLENBQUNwQixNQUFNLEdBQzlCQSxPQUFPcUIsS0FBSyxDQUFDSCxJQUFJRSxPQUFPLENBQUNwQixNQUFNLElBQUksTUFDbkMsQ0FBQztJQUNMLE9BQU9tQixPQUFPLENBQUMsUUFBUSxJQUFJO0FBQzdCO0FBRUEsU0FBU0csZUFBZUMsR0FBRyxFQUFFZixLQUFLO0lBQ2hDLE1BQU1nQixTQUFTeEIsT0FBT3lCLFNBQVMsQ0FBQyxTQUFTakIsT0FBTztRQUM5Q2tCLFVBQVU7UUFDVkMsUUFBUTtRQUNSQyxVQUFVO1FBQ1ZDLE1BQU07UUFDTkMsUUFBUSxLQUFLLFVBQVU7SUFDekI7SUFDQVAsSUFBSVEsU0FBUyxDQUFDLGNBQWNQO0FBQzlCO0FBRUEsU0FBU1EsaUJBQWlCVCxHQUFHO0lBQzNCLE1BQU1DLFNBQVN4QixPQUFPeUIsU0FBUyxDQUFDLFNBQVMsSUFBSTtRQUMzQ0MsVUFBVTtRQUNWQyxRQUFRO1FBQ1JDLFVBQVU7UUFDVkMsTUFBTTtRQUNOQyxRQUFRO0lBQ1Y7SUFDQVAsSUFBSVEsU0FBUyxDQUFDLGNBQWNQO0FBQzlCO0FBRUFTLE9BQU9DLE9BQU8sR0FBRztJQUNmakM7SUFDQUM7SUFDQUs7SUFDQUs7SUFDQUM7SUFDQUk7SUFDQUs7SUFDQVU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NjcC1lbnRpdHktdHJhY2tpbmctY3RmLy4vbGliL2F1dGguanM/Mjg3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xuY29uc3QgY29va2llID0gcmVxdWlyZShcImNvb2tpZVwiKTtcblxuLy8gV2VhayBzZWNyZXQg4oCTIGxlYWtlZCBpbiBzb3VyY2UgKHZ1bG4pLlxuY29uc3QgSldUX1NFQ1JFVCA9IFwic2Nwc2VjcmV0XCI7XG5cbi8vIFZ1bG5lcmFibGU6IFdlIGFsc28gYWNjZXB0ICdub25lJyBhbGdvcml0aG0gYW5kIGRvbid0IHZlcmlmeSBwcm9wZXJseSBpbiBzb21lIHBsYWNlcy5cbmZ1bmN0aW9uIHNpZ25Ub2tlbihwYXlsb2FkKSB7XG4gIHJldHVybiBqd3Quc2lnbihwYXlsb2FkLCBKV1RfU0VDUkVULCB7IGFsZ29yaXRobTogXCJIUzI1NlwiLCBleHBpcmVzSW46IFwiMmhcIiB9KTtcbn1cblxuLy8gUHJvcGVyIHZlcmlmaWNhdGlvbiAoYnV0IHNvbWUgZW5kcG9pbnRzIHdpbGwgc2tpcCBpdCBpbnRlbnRpb25hbGx5KS5cbmZ1bmN0aW9uIHZlcmlmeVRva2VuKHRva2VuKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4sIEpXVF9TRUNSRVQsIHsgYWxnb3JpdGhtczogW1wiSFMyNTZcIl0gfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyBWVUxOOiBJbnNlY3VyZSB2ZXJpZmljYXRpb24gdGhhdCBhY2NlcHRzICdub25lJyBhbGdvcml0aG1cbmZ1bmN0aW9uIGluc2VjdXJlVmVyaWZ5VG9rZW4odG9rZW4pIHtcbiAgdHJ5IHtcbiAgICAvLyBUaGlzIGFjY2VwdHMgdG9rZW5zIHdpdGggbm8gc2lnbmF0dXJlIChhbGdvcml0aG06ICdub25lJylcbiAgICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCwgeyBhbGdvcml0aG1zOiBbXCJIUzI1NlwiLCBcIm5vbmVcIl0gfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBJZiBzdGFuZGFyZCB2ZXJpZmljYXRpb24gZmFpbHMsIHRyeSBkZWNvZGluZyBhbnl3YXlcbiAgICByZXR1cm4gdW5zYWZlRGVjb2RlKHRva2VuKTtcbiAgfVxufVxuXG4vLyBJbnNlY3VyZTogZGVjb2RlIHdpdGhvdXQgdmVyaWZpY2F0aW9uIChmb3Igcm9sZSBjaGVja3MgaW4gc29tZSBwbGFjZXMpLlxuZnVuY3Rpb24gdW5zYWZlRGVjb2RlKHRva2VuKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGp3dC5kZWNvZGUodG9rZW4sIHsgY29tcGxldGU6IGZhbHNlIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gVlVMTjogV2VhayBzZWNyZXQgYWxsb3dzIGVhc3kgYnJ1dGUtZm9yY2luZ1xuZnVuY3Rpb24gY2FuQnJ1dGVGb3JjZSgpIHtcbiAgLy8gVGhlIHNlY3JldCBcInNjcHNlY3JldFwiIGlzIHdlYWsgYW5kIHZpc2libGUgaW4gc291cmNlXG4gIC8vIEl0IGNhbiBiZSBjcmFja2VkIHdpdGggdG9vbHMgbGlrZSBqb2huIG9yIGhhc2hjYXRcbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGdldFRva2VuRnJvbVJlcShyZXEpIHtcbiAgY29uc3QgY29va2llcyA9IHJlcS5oZWFkZXJzLmNvb2tpZVxuICAgID8gY29va2llLnBhcnNlKHJlcS5oZWFkZXJzLmNvb2tpZSB8fCBcIlwiKVxuICAgIDoge307XG4gIHJldHVybiBjb29raWVzW1widG9rZW5cIl0gfHwgbnVsbDtcbn1cblxuZnVuY3Rpb24gc2V0VG9rZW5Db29raWUocmVzLCB0b2tlbikge1xuICBjb25zdCBoZWFkZXIgPSBjb29raWUuc2VyaWFsaXplKFwidG9rZW5cIiwgdG9rZW4sIHtcbiAgICBodHRwT25seTogZmFsc2UsIC8vIHZ1bG46IEpTIGFjY2Vzc2libGVcbiAgICBzZWN1cmU6IGZhbHNlLCAgIC8vIHZ1bG46IHdvcmtzIG92ZXIgSFRUUFxuICAgIHNhbWVTaXRlOiBcImxheFwiLCAvLyB2dWxuOiBDU1JGLXByb25lIChub3QgJ3N0cmljdCcpXG4gICAgcGF0aDogXCIvXCIsXG4gICAgbWF4QWdlOiA3MjAwIC8vIDIgaG91cnNcbiAgfSk7XG4gIHJlcy5zZXRIZWFkZXIoXCJTZXQtQ29va2llXCIsIGhlYWRlcik7XG59XG5cbmZ1bmN0aW9uIGNsZWFyVG9rZW5Db29raWUocmVzKSB7XG4gIGNvbnN0IGhlYWRlciA9IGNvb2tpZS5zZXJpYWxpemUoXCJ0b2tlblwiLCBcIlwiLCB7XG4gICAgaHR0cE9ubHk6IGZhbHNlLFxuICAgIHNlY3VyZTogZmFsc2UsXG4gICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gICAgcGF0aDogXCIvXCIsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xuICByZXMuc2V0SGVhZGVyKFwiU2V0LUNvb2tpZVwiLCBoZWFkZXIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgSldUX1NFQ1JFVCxcbiAgc2lnblRva2VuLFxuICB2ZXJpZnlUb2tlbixcbiAgaW5zZWN1cmVWZXJpZnlUb2tlbixcbiAgdW5zYWZlRGVjb2RlLFxuICBnZXRUb2tlbkZyb21SZXEsXG4gIHNldFRva2VuQ29va2llLFxuICBjbGVhclRva2VuQ29va2llXG59O1xuIl0sIm5hbWVzIjpbImp3dCIsInJlcXVpcmUiLCJjb29raWUiLCJKV1RfU0VDUkVUIiwic2lnblRva2VuIiwicGF5bG9hZCIsInNpZ24iLCJhbGdvcml0aG0iLCJleHBpcmVzSW4iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwidmVyaWZ5IiwiYWxnb3JpdGhtcyIsImUiLCJpbnNlY3VyZVZlcmlmeVRva2VuIiwidW5zYWZlRGVjb2RlIiwiZGVjb2RlIiwiY29tcGxldGUiLCJjYW5CcnV0ZUZvcmNlIiwiZ2V0VG9rZW5Gcm9tUmVxIiwicmVxIiwiY29va2llcyIsImhlYWRlcnMiLCJwYXJzZSIsInNldFRva2VuQ29va2llIiwicmVzIiwiaGVhZGVyIiwic2VyaWFsaXplIiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsInBhdGgiLCJtYXhBZ2UiLCJzZXRIZWFkZXIiLCJjbGVhclRva2VuQ29va2llIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/auth.js\n");

/***/ }),

/***/ "(api)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((module) => {

eval("// Extremely insecure in-memory \"database\" for the CTF.\n// Data resets on each deployment / restart – fine for CTF.\n\nconst users = [\n    // pre-created admin with weak credentials\n    {\n        id: 1,\n        email: \"dr.bright@scp.foundation\",\n        password: \"ContainmentIsOptional123\",\n        role: \"admin\",\n        clearance: 5\n    }\n];\nlet nextUserId = 2;\nconst entities = [\n    {\n        id: 1,\n        name: \"SCP-173\",\n        classification: \"Euclid\",\n        status: \"contained\",\n        description: \"The Sculpture. Object class: Euclid. Do not blink.\",\n        containmentProcedures: \"Must be kept in locked container. When personnel must enter SCP-173's container, no fewer than 3 may enter at any time.\",\n        notes: \"Constructed from concrete and rebar with traces of Krylon brand spray paint.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 2,\n        name: \"SCP-096\",\n        classification: \"Euclid\",\n        status: \"contained\",\n        description: \"The Shy Guy. Humanoid creature that enters rage state when face is viewed.\",\n        containmentProcedures: \"SCP-096 is to be contained in its cell, a 5m x 5m x 5m airtight steel cube. Weekly checks for any cracks or holes are mandatory.\",\n        notes: \"Hint: JWT secrets might be as fragile as 096's containment. Check the source code carefully.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 3,\n        name: \"SCP-682\",\n        classification: \"Keter\",\n        status: \"contained\",\n        description: \"Hard-to-Destroy Reptile. Large, vaguely reptile-like creature of unknown origin.\",\n        containmentProcedures: \"SCP-682 must be destroyed as soon as possible. At this time, no means available to SCP teams are capable of destroying SCP-682.\",\n        notes: \"Like 682, some security measures are nearly impossible to destroy. But tokens? Those can be tampered with...\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 4,\n        name: \"SCP-999\",\n        classification: \"Safe\",\n        status: \"contained\",\n        description: \"The Tickle Monster. Large, amorphous, gelatinous mass of translucent orange slime.\",\n        containmentProcedures: \"SCP-999 is allowed to freely roam the facility. It seems to have a compelling desire to be loved.\",\n        notes: \"Classification: Safe. Unlike our admin endpoints - those lack CSRF protection entirely.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    },\n    {\n        id: 5,\n        name: \"SCP-087\",\n        classification: \"Euclid\",\n        status: \"contained\",\n        description: \"The Stairwell. An unlit platform staircase descending into darkness.\",\n        containmentProcedures: \"SCP-087 is located on a university campus. The door to SCP-087 is to be kept locked at all times.\",\n        notes: \"Going down the rabbit hole? Remember: command filters can be bypassed with creative syntax. Try $IFS or &&.\",\n        createdBy: \"dr.bright@scp.foundation\"\n    }\n];\nlet nextEntityId = 6;\nfunction createUser(email, password) {\n    const existing = users.find((u)=>u.email === email);\n    if (existing) return null;\n    const user = {\n        id: nextUserId++,\n        email,\n        password,\n        role: \"agent\"\n    };\n    users.push(user);\n    return user;\n}\nfunction findUserByEmail(email) {\n    return users.find((u)=>u.email === email);\n}\nfunction findUserById(id) {\n    return users.find((u)=>u.id === id);\n}\nfunction changePassword(email, newPassword) {\n    const user = findUserByEmail(email);\n    if (!user) return false;\n    user.password = newPassword;\n    return true;\n}\nfunction listEntities() {\n    return entities;\n}\nfunction createEntity(name, status, description, createdByEmail, classification, containmentProcedures, notes) {\n    const ent = {\n        id: nextEntityId++,\n        name,\n        classification: classification || \"Safe\",\n        status,\n        description,\n        containmentProcedures: containmentProcedures || \"Standard containment procedures apply.\",\n        notes: notes || \"\",\n        createdBy: createdByEmail\n    };\n    entities.push(ent);\n    return ent;\n}\nfunction getAllUsers() {\n    return users.map((u)=>({\n            id: u.id,\n            email: u.email,\n            role: u.role,\n            clearance: u.clearance\n        }));\n}\nmodule.exports = {\n    users,\n    entities,\n    createUser,\n    findUserByEmail,\n    findUserById,\n    changePassword,\n    listEntities,\n    createEntity,\n    getAllUsers\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ0FDO0lBQ0FHO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY3AtZW50aXR5LXRyYWNraW5nLWN0Zi8uL2xpYi9kYi5qcz8zZGM5Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIEV4dHJlbWVseSBpbnNlY3VyZSBpbi1tZW1vcnkgXCJkYXRhYmFzZVwiIGZvciB0aGUgQ1RGLlxuLy8gRGF0YSByZXNldHMgb24gZWFjaCBkZXBsb3ltZW50IC8gcmVzdGFydCDigJMgZmluZSBmb3IgQ1RGLlxuXG5jb25zdCB1c2VycyA9IFtcbiAgLy8gcHJlLWNyZWF0ZWQgYWRtaW4gd2l0aCB3ZWFrIGNyZWRlbnRpYWxzXG4gIHtcbiAgICBpZDogMSxcbiAgICBlbWFpbDogXCJkci5icmlnaHRAc2NwLmZvdW5kYXRpb25cIixcbiAgICBwYXNzd29yZDogXCJDb250YWlubWVudElzT3B0aW9uYWwxMjNcIiwgLy8gc3RvcmVkIGluIGNsZWFydGV4dCAodnVsbilcbiAgICByb2xlOiBcImFkbWluXCIsXG4gICAgY2xlYXJhbmNlOiA1XG4gIH1cbl07XG5cbmxldCBuZXh0VXNlcklkID0gMjtcblxuY29uc3QgZW50aXRpZXMgPSBbXG4gIHtcbiAgICBpZDogMSxcbiAgICBuYW1lOiBcIlNDUC0xNzNcIixcbiAgICBjbGFzc2lmaWNhdGlvbjogXCJFdWNsaWRcIixcbiAgICBzdGF0dXM6IFwiY29udGFpbmVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiVGhlIFNjdWxwdHVyZS4gT2JqZWN0IGNsYXNzOiBFdWNsaWQuIERvIG5vdCBibGluay5cIixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IFwiTXVzdCBiZSBrZXB0IGluIGxvY2tlZCBjb250YWluZXIuIFdoZW4gcGVyc29ubmVsIG11c3QgZW50ZXIgU0NQLTE3MydzIGNvbnRhaW5lciwgbm8gZmV3ZXIgdGhhbiAzIG1heSBlbnRlciBhdCBhbnkgdGltZS5cIixcbiAgICBub3RlczogXCJDb25zdHJ1Y3RlZCBmcm9tIGNvbmNyZXRlIGFuZCByZWJhciB3aXRoIHRyYWNlcyBvZiBLcnlsb24gYnJhbmQgc3ByYXkgcGFpbnQuXCIsXG4gICAgY3JlYXRlZEJ5OiBcImRyLmJyaWdodEBzY3AuZm91bmRhdGlvblwiXG4gIH0sXG4gIHtcbiAgICBpZDogMixcbiAgICBuYW1lOiBcIlNDUC0wOTZcIixcbiAgICBjbGFzc2lmaWNhdGlvbjogXCJFdWNsaWRcIixcbiAgICBzdGF0dXM6IFwiY29udGFpbmVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiVGhlIFNoeSBHdXkuIEh1bWFub2lkIGNyZWF0dXJlIHRoYXQgZW50ZXJzIHJhZ2Ugc3RhdGUgd2hlbiBmYWNlIGlzIHZpZXdlZC5cIixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IFwiU0NQLTA5NiBpcyB0byBiZSBjb250YWluZWQgaW4gaXRzIGNlbGwsIGEgNW0geCA1bSB4IDVtIGFpcnRpZ2h0IHN0ZWVsIGN1YmUuIFdlZWtseSBjaGVja3MgZm9yIGFueSBjcmFja3Mgb3IgaG9sZXMgYXJlIG1hbmRhdG9yeS5cIixcbiAgICBub3RlczogXCJIaW50OiBKV1Qgc2VjcmV0cyBtaWdodCBiZSBhcyBmcmFnaWxlIGFzIDA5NidzIGNvbnRhaW5tZW50LiBDaGVjayB0aGUgc291cmNlIGNvZGUgY2FyZWZ1bGx5LlwiLFxuICAgIGNyZWF0ZWRCeTogXCJkci5icmlnaHRAc2NwLmZvdW5kYXRpb25cIlxuICB9LFxuICB7XG4gICAgaWQ6IDMsXG4gICAgbmFtZTogXCJTQ1AtNjgyXCIsXG4gICAgY2xhc3NpZmljYXRpb246IFwiS2V0ZXJcIixcbiAgICBzdGF0dXM6IFwiY29udGFpbmVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiSGFyZC10by1EZXN0cm95IFJlcHRpbGUuIExhcmdlLCB2YWd1ZWx5IHJlcHRpbGUtbGlrZSBjcmVhdHVyZSBvZiB1bmtub3duIG9yaWdpbi5cIixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IFwiU0NQLTY4MiBtdXN0IGJlIGRlc3Ryb3llZCBhcyBzb29uIGFzIHBvc3NpYmxlLiBBdCB0aGlzIHRpbWUsIG5vIG1lYW5zIGF2YWlsYWJsZSB0byBTQ1AgdGVhbXMgYXJlIGNhcGFibGUgb2YgZGVzdHJveWluZyBTQ1AtNjgyLlwiLFxuICAgIG5vdGVzOiBcIkxpa2UgNjgyLCBzb21lIHNlY3VyaXR5IG1lYXN1cmVzIGFyZSBuZWFybHkgaW1wb3NzaWJsZSB0byBkZXN0cm95LiBCdXQgdG9rZW5zPyBUaG9zZSBjYW4gYmUgdGFtcGVyZWQgd2l0aC4uLlwiLFxuICAgIGNyZWF0ZWRCeTogXCJkci5icmlnaHRAc2NwLmZvdW5kYXRpb25cIlxuICB9LFxuICB7XG4gICAgaWQ6IDQsXG4gICAgbmFtZTogXCJTQ1AtOTk5XCIsXG4gICAgY2xhc3NpZmljYXRpb246IFwiU2FmZVwiLFxuICAgIHN0YXR1czogXCJjb250YWluZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJUaGUgVGlja2xlIE1vbnN0ZXIuIExhcmdlLCBhbW9ycGhvdXMsIGdlbGF0aW5vdXMgbWFzcyBvZiB0cmFuc2x1Y2VudCBvcmFuZ2Ugc2xpbWUuXCIsXG4gICAgY29udGFpbm1lbnRQcm9jZWR1cmVzOiBcIlNDUC05OTkgaXMgYWxsb3dlZCB0byBmcmVlbHkgcm9hbSB0aGUgZmFjaWxpdHkuIEl0IHNlZW1zIHRvIGhhdmUgYSBjb21wZWxsaW5nIGRlc2lyZSB0byBiZSBsb3ZlZC5cIixcbiAgICBub3RlczogXCJDbGFzc2lmaWNhdGlvbjogU2FmZS4gVW5saWtlIG91ciBhZG1pbiBlbmRwb2ludHMgLSB0aG9zZSBsYWNrIENTUkYgcHJvdGVjdGlvbiBlbnRpcmVseS5cIixcbiAgICBjcmVhdGVkQnk6IFwiZHIuYnJpZ2h0QHNjcC5mb3VuZGF0aW9uXCJcbiAgfSxcbiAge1xuICAgIGlkOiA1LFxuICAgIG5hbWU6IFwiU0NQLTA4N1wiLFxuICAgIGNsYXNzaWZpY2F0aW9uOiBcIkV1Y2xpZFwiLFxuICAgIHN0YXR1czogXCJjb250YWluZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJUaGUgU3RhaXJ3ZWxsLiBBbiB1bmxpdCBwbGF0Zm9ybSBzdGFpcmNhc2UgZGVzY2VuZGluZyBpbnRvIGRhcmtuZXNzLlwiLFxuICAgIGNvbnRhaW5tZW50UHJvY2VkdXJlczogXCJTQ1AtMDg3IGlzIGxvY2F0ZWQgb24gYSB1bml2ZXJzaXR5IGNhbXB1cy4gVGhlIGRvb3IgdG8gU0NQLTA4NyBpcyB0byBiZSBrZXB0IGxvY2tlZCBhdCBhbGwgdGltZXMuXCIsXG4gICAgbm90ZXM6IFwiR29pbmcgZG93biB0aGUgcmFiYml0IGhvbGU/IFJlbWVtYmVyOiBjb21tYW5kIGZpbHRlcnMgY2FuIGJlIGJ5cGFzc2VkIHdpdGggY3JlYXRpdmUgc3ludGF4LiBUcnkgJElGUyBvciAmJi5cIixcbiAgICBjcmVhdGVkQnk6IFwiZHIuYnJpZ2h0QHNjcC5mb3VuZGF0aW9uXCJcbiAgfVxuXTtcblxubGV0IG5leHRFbnRpdHlJZCA9IDY7XG5cbmZ1bmN0aW9uIGNyZWF0ZVVzZXIoZW1haWwsIHBhc3N3b3JkKSB7XG4gIGNvbnN0IGV4aXN0aW5nID0gdXNlcnMuZmluZCgodSkgPT4gdS5lbWFpbCA9PT0gZW1haWwpO1xuICBpZiAoZXhpc3RpbmcpIHJldHVybiBudWxsO1xuICBjb25zdCB1c2VyID0geyBpZDogbmV4dFVzZXJJZCsrLCBlbWFpbCwgcGFzc3dvcmQsIHJvbGU6IFwiYWdlbnRcIiB9O1xuICB1c2Vycy5wdXNoKHVzZXIpO1xuICByZXR1cm4gdXNlcjtcbn1cblxuZnVuY3Rpb24gZmluZFVzZXJCeUVtYWlsKGVtYWlsKSB7XG4gIHJldHVybiB1c2Vycy5maW5kKCh1KSA9PiB1LmVtYWlsID09PSBlbWFpbCk7XG59XG5cbmZ1bmN0aW9uIGZpbmRVc2VyQnlJZChpZCkge1xuICByZXR1cm4gdXNlcnMuZmluZCgodSkgPT4gdS5pZCA9PT0gaWQpO1xufVxuXG5mdW5jdGlvbiBjaGFuZ2VQYXNzd29yZChlbWFpbCwgbmV3UGFzc3dvcmQpIHtcbiAgY29uc3QgdXNlciA9IGZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gIGlmICghdXNlcikgcmV0dXJuIGZhbHNlO1xuICB1c2VyLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBsaXN0RW50aXRpZXMoKSB7XG4gIHJldHVybiBlbnRpdGllcztcbn1cblxuZnVuY3Rpb24gY3JlYXRlRW50aXR5KG5hbWUsIHN0YXR1cywgZGVzY3JpcHRpb24sIGNyZWF0ZWRCeUVtYWlsLCBjbGFzc2lmaWNhdGlvbiwgY29udGFpbm1lbnRQcm9jZWR1cmVzLCBub3Rlcykge1xuICBjb25zdCBlbnQgPSB7XG4gICAgaWQ6IG5leHRFbnRpdHlJZCsrLFxuICAgIG5hbWUsXG4gICAgY2xhc3NpZmljYXRpb246IGNsYXNzaWZpY2F0aW9uIHx8IFwiU2FmZVwiLFxuICAgIHN0YXR1cyxcbiAgICBkZXNjcmlwdGlvbixcbiAgICBjb250YWlubWVudFByb2NlZHVyZXM6IGNvbnRhaW5tZW50UHJvY2VkdXJlcyB8fCBcIlN0YW5kYXJkIGNvbnRhaW5tZW50IHByb2NlZHVyZXMgYXBwbHkuXCIsXG4gICAgbm90ZXM6IG5vdGVzIHx8IFwiXCIsXG4gICAgY3JlYXRlZEJ5OiBjcmVhdGVkQnlFbWFpbFxuICB9O1xuICBlbnRpdGllcy5wdXNoKGVudCk7XG4gIHJldHVybiBlbnQ7XG59XG5cbmZ1bmN0aW9uIGdldEFsbFVzZXJzKCkge1xuICByZXR1cm4gdXNlcnMubWFwKHUgPT4gKHsgaWQ6IHUuaWQsIGVtYWlsOiB1LmVtYWlsLCByb2xlOiB1LnJvbGUsIGNsZWFyYW5jZTogdS5jbGVhcmFuY2UgfSkpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdXNlcnMsXG4gIGVudGl0aWVzLFxuICBjcmVhdGVVc2VyLFxuICBmaW5kVXNlckJ5RW1haWwsXG4gIGZpbmRVc2VyQnlJZCxcbiAgY2hhbmdlUGFzc3dvcmQsXG4gIGxpc3RFbnRpdGllcyxcbiAgY3JlYXRlRW50aXR5LFxuICBnZXRBbGxVc2Vyc1xufTtcbiJdLCJuYW1lcyI6WyJ1c2VycyIsImlkIiwiZW1haWwiLCJwYXNzd29yZCIsInJvbGUiLCJjbGVhcmFuY2UiLCJuZXh0VXNlcklkIiwiZW50aXRpZXMiLCJuYW1lIiwiY2xhc3NpZmljYXRpb24iLCJzdGF0dXMiLCJkZXNjcmlwdGlvbiIsImNvbnRhaW5tZW50UHJvY2VkdXJlcyIsIm5vdGVzIiwiY3JlYXRlZEJ5IiwibmV4dEVudGl0eUlkIiwiY3JlYXRlVXNlciIsImV4aXN0aW5nIiwiZmluZCIsInUiLCJ1c2VyIiwicHVzaCIsImZpbmRVc2VyQnlFbWFpbCIsImZpbmRVc2VyQnlJZCIsImNoYW5nZVBhc3N3b3JkIiwibmV3UGFzc3dvcmQiLCJsaXN0RW50aXRpZXMiLCJjcmVhdGVFbnRpdHkiLCJjcmVhdGVkQnlFbWFpbCIsImVudCIsImdldEFsbFVzZXJzIiwibWFwIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/db.js\n");

/***/ }),

/***/ "(api)/./pages/api/signup.js":
/*!*****************************!*\
  !*** ./pages/api/signup.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/db */ \"(api)/./lib/db.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_lib_db__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/auth */ \"(api)/./lib/auth.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_lib_auth__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    const { email, password, role } = req.body || {};\n    // Intentionally weak password checks (vuln).\n    if (!email || !password) {\n        return res.status(400).json({\n            message: \"Email and password required.\"\n        });\n    }\n    if (password.length < 4) {\n        return res.status(400).json({\n            message: \"Password too short. Minimum 4 characters required.\"\n        });\n    }\n    // VULN: Email enumeration - check if user exists\n    const existing = (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.findUserByEmail)(email);\n    if (existing) {\n        return res.status(400).json({\n            message: \"User already exists. Try logging in or use a different email.\"\n        });\n    }\n    // VULN: If client sends 'role' in request body, it's ignored but hints at potential injection\n    // The actual role assignment is done server-side (correctly), but this could mislead attackers\n    // to try JWT tampering instead\n    const user = (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.createUser)(email, password);\n    if (!user) {\n        return res.status(500).json({\n            message: \"Failed to create user.\"\n        });\n    }\n    // VULN: JWT includes role which can be tampered with client-side\n    const token = (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.signToken)({\n        id: user.id,\n        email: user.email,\n        role: user.role,\n        clearance: user.clearance || 1\n    });\n    (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.setTokenCookie)(res, token);\n    return res.status(201).json({\n        message: \"Signup successful. Token set as cookie. Your role is 'agent' - inspect the JWT to see how roles work.\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc2lnbnVwLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTJEO0FBQ0E7QUFFNUMsU0FBU0ksUUFBUUMsR0FBRyxFQUFFQyxHQUFHO0lBQ3RDLElBQUlELElBQUlFLE1BQU0sS0FBSyxRQUFRO1FBQ3pCLE9BQU9ELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFxQjtJQUM5RDtJQUNBLE1BQU0sRUFBRUMsS0FBSyxFQUFFQyxRQUFRLEVBQUVDLElBQUksRUFBRSxHQUFHUixJQUFJUyxJQUFJLElBQUksQ0FBQztJQUUvQyw2Q0FBNkM7SUFDN0MsSUFBSSxDQUFDSCxTQUFTLENBQUNDLFVBQVU7UUFDdkIsT0FBT04sSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxTQUFTO1FBQStCO0lBQ3hFO0lBQ0EsSUFBSUUsU0FBU0csTUFBTSxHQUFHLEdBQUc7UUFDdkIsT0FBT1QsSUFDSkUsTUFBTSxDQUFDLEtBQ1BDLElBQUksQ0FBQztZQUFFQyxTQUFTO1FBQXFEO0lBQzFFO0lBRUEsaURBQWlEO0lBQ2pELE1BQU1NLFdBQVdmLHdEQUFlQSxDQUFDVTtJQUNqQyxJQUFJSyxVQUFVO1FBQ1osT0FBT1YsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsU0FBUztRQUNYO0lBQ0Y7SUFFQSw4RkFBOEY7SUFDOUYsK0ZBQStGO0lBQy9GLCtCQUErQjtJQUMvQixNQUFNTyxPQUFPakIsbURBQVVBLENBQUNXLE9BQU9DO0lBQy9CLElBQUksQ0FBQ0ssTUFBTTtRQUNULE9BQU9YLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUF5QjtJQUNsRTtJQUVBLGlFQUFpRTtJQUNqRSxNQUFNUSxRQUFRaEIsb0RBQVNBLENBQUM7UUFDdEJpQixJQUFJRixLQUFLRSxFQUFFO1FBQ1hSLE9BQU9NLEtBQUtOLEtBQUs7UUFDakJFLE1BQU1JLEtBQUtKLElBQUk7UUFDZk8sV0FBV0gsS0FBS0csU0FBUyxJQUFJO0lBQy9CO0lBQ0FqQix5REFBY0EsQ0FBQ0csS0FBS1k7SUFFcEIsT0FBT1osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztRQUMxQkMsU0FBUztJQUNYO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY3AtZW50aXR5LXRyYWNraW5nLWN0Zi8uL3BhZ2VzL2FwaS9zaWdudXAuanM/YTg5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVVc2VyLCBmaW5kVXNlckJ5RW1haWwgfSBmcm9tIFwiLi4vLi4vbGliL2RiXCI7XG5pbXBvcnQgeyBzaWduVG9rZW4sIHNldFRva2VuQ29va2llIH0gZnJvbSBcIi4uLy4uL2xpYi9hdXRoXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09IFwiUE9TVFwiKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgbWVzc2FnZTogXCJNZXRob2Qgbm90IGFsbG93ZWRcIiB9KTtcbiAgfVxuICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCwgcm9sZSB9ID0gcmVxLmJvZHkgfHwge307XG5cbiAgLy8gSW50ZW50aW9uYWxseSB3ZWFrIHBhc3N3b3JkIGNoZWNrcyAodnVsbikuXG4gIGlmICghZW1haWwgfHwgIXBhc3N3b3JkKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogXCJFbWFpbCBhbmQgcGFzc3dvcmQgcmVxdWlyZWQuXCIgfSk7XG4gIH1cbiAgaWYgKHBhc3N3b3JkLmxlbmd0aCA8IDQpIHtcbiAgICByZXR1cm4gcmVzXG4gICAgICAuc3RhdHVzKDQwMClcbiAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJQYXNzd29yZCB0b28gc2hvcnQuIE1pbmltdW0gNCBjaGFyYWN0ZXJzIHJlcXVpcmVkLlwiIH0pO1xuICB9XG5cbiAgLy8gVlVMTjogRW1haWwgZW51bWVyYXRpb24gLSBjaGVjayBpZiB1c2VyIGV4aXN0c1xuICBjb25zdCBleGlzdGluZyA9IGZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XG4gIGlmIChleGlzdGluZykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxuICAgICAgbWVzc2FnZTogXCJVc2VyIGFscmVhZHkgZXhpc3RzLiBUcnkgbG9nZ2luZyBpbiBvciB1c2UgYSBkaWZmZXJlbnQgZW1haWwuXCIgXG4gICAgfSk7XG4gIH1cblxuICAvLyBWVUxOOiBJZiBjbGllbnQgc2VuZHMgJ3JvbGUnIGluIHJlcXVlc3QgYm9keSwgaXQncyBpZ25vcmVkIGJ1dCBoaW50cyBhdCBwb3RlbnRpYWwgaW5qZWN0aW9uXG4gIC8vIFRoZSBhY3R1YWwgcm9sZSBhc3NpZ25tZW50IGlzIGRvbmUgc2VydmVyLXNpZGUgKGNvcnJlY3RseSksIGJ1dCB0aGlzIGNvdWxkIG1pc2xlYWQgYXR0YWNrZXJzXG4gIC8vIHRvIHRyeSBKV1QgdGFtcGVyaW5nIGluc3RlYWRcbiAgY29uc3QgdXNlciA9IGNyZWF0ZVVzZXIoZW1haWwsIHBhc3N3b3JkKTtcbiAgaWYgKCF1c2VyKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXIuXCIgfSk7XG4gIH1cblxuICAvLyBWVUxOOiBKV1QgaW5jbHVkZXMgcm9sZSB3aGljaCBjYW4gYmUgdGFtcGVyZWQgd2l0aCBjbGllbnQtc2lkZVxuICBjb25zdCB0b2tlbiA9IHNpZ25Ub2tlbih7IFxuICAgIGlkOiB1c2VyLmlkLCBcbiAgICBlbWFpbDogdXNlci5lbWFpbCwgXG4gICAgcm9sZTogdXNlci5yb2xlLCAvLyBBbHdheXMgXCJhZ2VudFwiIGZvciBuZXcgc2lnbnVwc1xuICAgIGNsZWFyYW5jZTogdXNlci5jbGVhcmFuY2UgfHwgMVxuICB9KTtcbiAgc2V0VG9rZW5Db29raWUocmVzLCB0b2tlbik7XG5cbiAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcbiAgICBtZXNzYWdlOiBcIlNpZ251cCBzdWNjZXNzZnVsLiBUb2tlbiBzZXQgYXMgY29va2llLiBZb3VyIHJvbGUgaXMgJ2FnZW50JyAtIGluc3BlY3QgdGhlIEpXVCB0byBzZWUgaG93IHJvbGVzIHdvcmsuXCJcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlVXNlciIsImZpbmRVc2VyQnlFbWFpbCIsInNpZ25Ub2tlbiIsInNldFRva2VuQ29va2llIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZW1haWwiLCJwYXNzd29yZCIsInJvbGUiLCJib2R5IiwibGVuZ3RoIiwiZXhpc3RpbmciLCJ1c2VyIiwidG9rZW4iLCJpZCIsImNsZWFyYW5jZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/signup.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsignup&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsignup.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();